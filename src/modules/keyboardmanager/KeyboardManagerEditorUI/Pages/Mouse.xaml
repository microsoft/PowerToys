<?xml version="1.0" encoding="utf-8" ?>
<Page
    x:Class="KeyboardManagerEditorUI.Pages.Mouse"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="using:KeyboardManagerEditorUI.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:helper="using:KeyboardManagerEditorUI.Helpers"
    xmlns:local="using:KeyboardManagerEditorUI.Pages"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid Padding="16">
        <Pivot x:Name="MousePivot">
            <!-- Mouse to Key Remappings Tab -->
            <PivotItem x:Uid="MousePage_MouseToKeyPivot">
                <StackPanel Orientation="Vertical" Spacing="12" Margin="0,12,0,0">
                    <TextBlock
                        x:Uid="MousePage_MouseToKeyDescription"
                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                        TextWrapping="Wrap" />
                    <Button
                        x:Name="NewMouseToKeyBtn"
                        Height="36"
                        Margin="0,12,0,0"
                        Click="NewMouseToKeyBtn_Click">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon
                                FontSize="14"
                                Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                                Glyph="&#xE109;" />
                            <TextBlock x:Uid="MousePage_AddRemappingButton" VerticalAlignment="Center" />
                        </StackPanel>
                    </Button>
                    <Grid
                        HorizontalAlignment="Stretch"
                        Background="{ThemeResource LayerFillColorDefaultBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="{StaticResource OverlayCornerRadius}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="48" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="180" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="84" />
                        </Grid.ColumnDefinitions>
                        <TextBlock
                            x:Uid="MousePage_MouseButtonHeader"
                            Grid.Column="0"
                            Margin="16,-2,0,0"
                            VerticalAlignment="Center"
                            Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                        <AppBarSeparator
                            Grid.Column="1"
                            Margin="-6,4,0,4"
                            HorizontalAlignment="Left" />
                        <TextBlock
                            x:Uid="MousePage_ActionHeader"
                            Grid.Column="1"
                            Margin="12,-2,0,0"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                        <Rectangle
                            Grid.ColumnSpan="3"
                            Height="1"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Bottom"
                            Fill="{ThemeResource CardStrokeColorDefaultBrush}" />
                        <ListView
                            Grid.Row="1"
                            Grid.ColumnSpan="3"
                            IsItemClickEnabled="True"
                            ItemClick="MouseToKeyListView_ItemClick"
                            ItemsSource="{x:Bind MouseToKeyMappings}"
                            SelectionMode="None">
                            <ListView.ItemTemplate>
                                <DataTemplate x:DataType="helper:MouseMapping">
                                    <Grid Height="48">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="180" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="84" />
                                        </Grid.ColumnDefinitions>
                                        <Rectangle
                                            Grid.ColumnSpan="3"
                                            Height="1"
                                            Margin="-16,0,-16,0"
                                            HorizontalAlignment="Stretch"
                                            VerticalAlignment="Bottom"
                                            Fill="{ThemeResource CardStrokeColorDefaultBrush}"
                                            Opacity="0.8" />
                                        <TextBlock
                                            Grid.Column="0"
                                            VerticalAlignment="Center"
                                            Text="{x:Bind OriginalButton}"
                                            FontWeight="SemiBold" />
                                        <StackPanel
                                            Grid.Column="1"
                                            Orientation="Horizontal"
                                            Spacing="8">
                                            <TextBlock
                                                VerticalAlignment="Center"
                                                Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                Text="{x:Bind TargetType}" />
                                            <TextBlock
                                                VerticalAlignment="Center"
                                                Text="{x:Bind TargetDisplayName}" />
                                        </StackPanel>
                                        <Button
                                            Grid.Column="2"
                                            Margin="0,0,4,0"
                                            Padding="8,4"
                                            HorizontalAlignment="Right"
                                            VerticalAlignment="Center"
                                            AutomationProperties.Name="Delete mouse remapping"
                                            Background="Transparent"
                                            BorderThickness="0"
                                            Click="DeleteMouseToKeyBtn_Click"
                                            Tag="{x:Bind}">
                                            <FontIcon
                                                FontFamily="{StaticResource SymbolThemeFontFamily}"
                                                FontSize="16"
                                                Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                Glyph="&#xE74D;" />
                                        </Button>
                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </Grid>
                </StackPanel>
            </PivotItem>

            <!-- Key to Mouse Remappings Tab -->
            <PivotItem x:Uid="MousePage_KeyToMousePivot">
                <StackPanel Orientation="Vertical" Spacing="12" Margin="0,12,0,0">
                    <TextBlock
                        x:Uid="MousePage_KeyToMouseDescription"
                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                        TextWrapping="Wrap" />
                    <Button
                        x:Name="NewKeyToMouseBtn"
                        Height="36"
                        Margin="0,12,0,0"
                        Click="NewKeyToMouseBtn_Click">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon
                                FontSize="14"
                                Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                                Glyph="&#xE109;" />
                            <TextBlock x:Uid="MousePage_AddRemappingButton" VerticalAlignment="Center" />
                        </StackPanel>
                    </Button>
                    <Grid
                        HorizontalAlignment="Stretch"
                        Background="{ThemeResource LayerFillColorDefaultBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="{StaticResource OverlayCornerRadius}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="48" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="180" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="84" />
                        </Grid.ColumnDefinitions>
                        <TextBlock
                            x:Uid="MousePage_KeyHeader"
                            Grid.Column="0"
                            Margin="16,-2,0,0"
                            VerticalAlignment="Center"
                            Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                        <AppBarSeparator
                            Grid.Column="1"
                            Margin="-6,4,0,4"
                            HorizontalAlignment="Left" />
                        <TextBlock
                            x:Uid="MousePage_MouseButtonHeader"
                            Grid.Column="1"
                            Margin="12,-2,0,0"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                        <Rectangle
                            Grid.ColumnSpan="3"
                            Height="1"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Bottom"
                            Fill="{ThemeResource CardStrokeColorDefaultBrush}" />
                        <ListView
                            Grid.Row="1"
                            Grid.ColumnSpan="3"
                            IsItemClickEnabled="True"
                            ItemClick="KeyToMouseListView_ItemClick"
                            ItemsSource="{x:Bind KeyToMouseMappings}"
                            SelectionMode="None">
                            <ListView.ItemTemplate>
                                <DataTemplate x:DataType="helper:KeyToMouseMapping">
                                    <Grid Height="48">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="180" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="84" />
                                        </Grid.ColumnDefinitions>
                                        <Rectangle
                                            Grid.ColumnSpan="3"
                                            Height="1"
                                            Margin="-16,0,-16,0"
                                            HorizontalAlignment="Stretch"
                                            VerticalAlignment="Bottom"
                                            Fill="{ThemeResource CardStrokeColorDefaultBrush}"
                                            Opacity="0.8" />
                                        <controls:KeyVisual
                                            Grid.Column="0"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center"
                                            Content="{x:Bind OriginalKeyName}"
                                            Style="{StaticResource DefaultKeyVisualStyle}" />
                                        <TextBlock
                                            Grid.Column="1"
                                            VerticalAlignment="Center"
                                            Text="{x:Bind TargetMouseButton}"
                                            FontWeight="SemiBold" />
                                        <Button
                                            Grid.Column="2"
                                            Margin="0,0,4,0"
                                            Padding="8,4"
                                            HorizontalAlignment="Right"
                                            VerticalAlignment="Center"
                                            AutomationProperties.Name="Delete key to mouse remapping"
                                            Background="Transparent"
                                            BorderThickness="0"
                                            Click="DeleteKeyToMouseBtn_Click"
                                            Tag="{x:Bind}">
                                            <FontIcon
                                                FontFamily="{StaticResource SymbolThemeFontFamily}"
                                                FontSize="16"
                                                Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                Glyph="&#xE74D;" />
                                        </Button>
                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </Grid>
                </StackPanel>
            </PivotItem>
        </Pivot>

        <!-- Mouse to Key Dialog -->
        <ContentDialog
            x:Name="MouseToKeyDialog"
            x:Uid="MousePage_MouseToKeyDialog"
            MinWidth="500"
            MaxWidth="500"
            PrimaryButtonStyle="{StaticResource AccentButtonStyle}">
            <StackPanel Spacing="16" Margin="0,16,0,0">
                <ComboBox
                    x:Name="MouseButtonComboBox"
                    x:Uid="MousePage_MouseButtonComboBox"
                    Width="200"
                    SelectedIndex="0">
                    <ComboBoxItem x:Uid="MousePage_MouseButton_Left" />
                    <ComboBoxItem x:Uid="MousePage_MouseButton_Right" />
                    <ComboBoxItem x:Uid="MousePage_MouseButton_Middle" />
                    <ComboBoxItem x:Uid="MousePage_MouseButton_X1" />
                    <ComboBoxItem x:Uid="MousePage_MouseButton_X2" />
                </ComboBox>
                <ComboBox
                    x:Name="TargetTypeComboBox"
                    x:Uid="MousePage_TargetTypeComboBox"
                    Width="200"
                    SelectedIndex="0"
                    SelectionChanged="TargetTypeComboBox_SelectionChanged">
                    <ComboBoxItem x:Uid="MousePage_TargetType_Key" />
                    <ComboBoxItem x:Uid="MousePage_TargetType_Shortcut" />
                    <ComboBoxItem x:Uid="MousePage_TargetType_Text" />
                    <ComboBoxItem x:Uid="MousePage_TargetType_RunProgram" />
                    <ComboBoxItem x:Uid="MousePage_TargetType_OpenUrl" />
                </ComboBox>
                
                <!-- Key input -->
                <StackPanel x:Name="KeyInputPanel" Spacing="8">
                    <TextBlock x:Uid="MousePage_PressKeyToCapture" />
                    <TextBox
                        x:Name="KeyInputTextBox"
                        x:Uid="MousePage_KeyInputTextBox"
                        Width="200"
                        IsReadOnly="True"
                        PreviewKeyDown="KeyInputTextBox_PreviewKeyDown" />
                </StackPanel>
                
                <!-- Shortcut input -->
                <StackPanel x:Name="ShortcutInputPanel" Spacing="8" Visibility="Collapsed">
                    <TextBlock x:Uid="MousePage_ShortcutCodesLabel" />
                    <TextBox
                        x:Name="ShortcutInputTextBox"
                        x:Uid="MousePage_ShortcutInputTextBox"
                        Width="300" />
                </StackPanel>
                
                <!-- Text input -->
                <StackPanel x:Name="TextInputPanel" Spacing="8" Visibility="Collapsed">
                    <TextBlock x:Uid="MousePage_TextToTypeLabel" />
                    <TextBox
                        x:Name="TextInputTextBox"
                        x:Uid="MousePage_TextInputTextBox"
                        Width="300" />
                </StackPanel>
                
                <!-- Program input -->
                <StackPanel x:Name="ProgramInputPanel" Spacing="8" Visibility="Collapsed">
                    <TextBlock x:Uid="MousePage_ProgramPathLabel" />
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <TextBox
                            x:Name="ProgramPathTextBox"
                            x:Uid="MousePage_ProgramPathTextBox" />
                        <Button Grid.Column="1" Margin="8,0,0,0" Click="BrowseProgramBtn_Click">
                            <FontIcon Glyph="&#xED25;" FontSize="14" />
                        </Button>
                    </Grid>
                    <TextBlock x:Uid="MousePage_ProgramArgsLabel" />
                    <TextBox
                        x:Name="ProgramArgsTextBox"
                        x:Uid="MousePage_ProgramArgsTextBox"
                        Width="300" />
                </StackPanel>
                
                <!-- URL input -->
                <StackPanel x:Name="UrlInputPanel" Spacing="8" Visibility="Collapsed">
                    <TextBlock x:Uid="MousePage_UrlToOpenLabel" />
                    <TextBox
                        x:Name="UrlInputTextBox"
                        x:Uid="MousePage_UrlInputTextBox"
                        Width="300" />
                </StackPanel>
                
                <!-- App-specific remapping -->
                <StackPanel Spacing="8" Margin="0,8,0,0">
                    <CheckBox
                        x:Name="MouseToKeyAllAppsCheckBox"
                        x:Uid="MousePage_AllAppsCheckBox"
                        IsChecked="True"
                        Checked="MouseToKeyAllAppsCheckBox_Changed"
                        Unchecked="MouseToKeyAllAppsCheckBox_Changed" />
                    <TextBox
                        x:Name="MouseToKeyTargetAppTextBox"
                        x:Uid="MousePage_TargetAppTextBox"
                        Width="250"
                        Visibility="Collapsed" />
                </StackPanel>
            </StackPanel>
        </ContentDialog>

        <!-- Key to Mouse Dialog -->
        <ContentDialog
            x:Name="KeyToMouseDialog"
            x:Uid="MousePage_KeyToMouseDialog"
            MinWidth="400"
            MaxWidth="400"
            PrimaryButtonStyle="{StaticResource AccentButtonStyle}">
            <StackPanel Spacing="16" Margin="0,16,0,0">
                <StackPanel Spacing="8">
                    <TextBlock x:Uid="MousePage_PressKeyToCapture" />
                    <TextBox
                        x:Name="KeyToMouseKeyTextBox"
                        x:Uid="MousePage_KeyInputTextBox"
                        Width="200"
                        IsReadOnly="True"
                        PreviewKeyDown="KeyToMouseKeyTextBox_PreviewKeyDown" />
                </StackPanel>
                <ComboBox
                    x:Name="TargetMouseButtonComboBox"
                    x:Uid="MousePage_TargetMouseButtonComboBox"
                    Width="200"
                    SelectedIndex="0">
                    <ComboBoxItem x:Uid="MousePage_MouseButton_Left" />
                    <ComboBoxItem x:Uid="MousePage_MouseButton_Right" />
                    <ComboBoxItem x:Uid="MousePage_MouseButton_Middle" />
                    <ComboBoxItem x:Uid="MousePage_MouseButton_X1" />
                    <ComboBoxItem x:Uid="MousePage_MouseButton_X2" />
                </ComboBox>
                
                <!-- App-specific remapping -->
                <StackPanel Spacing="8" Margin="0,8,0,0">
                    <CheckBox
                        x:Name="KeyToMouseAllAppsCheckBox"
                        x:Uid="MousePage_AllAppsCheckBox"
                        IsChecked="True"
                        Checked="KeyToMouseAllAppsCheckBox_Changed"
                        Unchecked="KeyToMouseAllAppsCheckBox_Changed" />
                    <TextBox
                        x:Name="KeyToMouseTargetAppTextBox"
                        x:Uid="MousePage_TargetAppTextBox"
                        Width="250"
                        Visibility="Collapsed" />
                </StackPanel>
            </StackPanel>
        </ContentDialog>
    </Grid>
</Page>