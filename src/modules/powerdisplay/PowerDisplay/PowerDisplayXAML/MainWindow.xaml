<winuiex:WindowEx
    x:Class="PowerDisplay.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:animations="using:CommunityToolkit.WinUI.Animations"
    xmlns:converters="using:PowerDisplay.Converters"
    xmlns:toolkit="using:CommunityToolkit.WinUI.Controls"
    xmlns:ui="using:CommunityToolkit.WinUI"
    xmlns:vm="using:PowerDisplay.ViewModels"
    xmlns:winuiex="using:WinUIEx"
    IsAlwaysOnTop="True"
    IsMaximizable="False"
    IsMinimizable="False"
    IsResizable="False"
    IsShownInSwitchers="False"
    IsTitleBarVisible="False">
    <winuiex:WindowEx.Backdrop>
        <winuiex:AcrylicSystemBackdrop
            DarkFallbackColor="#1c1c1c"
            DarkLuminosityOpacity="0.96"
            DarkTintColor="#202020"
            DarkTintOpacity="0.5"
            LightFallbackColor="#EEEEEE"
            LightLuminosityOpacity="0.90"
            LightTintColor="#F3F3F3"
            LightTintOpacity="0" />
    </winuiex:WindowEx.Backdrop>

    <Grid x:Name="RootGrid">
        <Grid.Resources>
            <Style
                x:Key="FlyoutButtonStyle"
                BasedOn="{StaticResource SubtleButtonStyle}"
                TargetType="Button">
                <Setter Property="Padding" Value="6" />
                <Setter Property="Width" Value="32" />
                <Setter Property="Height" Value="32" />
                <Setter Property="FontFamily" Value="{ThemeResource SymbolThemeFontFamily}" />
            </Style>
        </Grid.Resources>
        <Border x:Name="MainContainer">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="48" />
                </Grid.RowDefinitions>

                <!--  Main Container with modern design  -->
                <Grid
                    Background="{ThemeResource LayerOnAcrylicFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="0,0,0,1">
                    <StackPanel
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Orientation="Vertical"
                        Spacing="16"
                        Visibility="{x:Bind ConvertBoolToVisibility(ViewModel.IsScanning), Mode=OneWay}">
                        <ProgressRing
                            Width="32"
                            Height="32"
                            Foreground="{ThemeResource AccentFillColorDefaultBrush}"
                            IsActive="True" />
                        <TextBlock
                            x:Name="ScanningMonitorsTextBlock"
                            HorizontalAlignment="Center"
                            FontSize="12"
                            TextAlignment="Center" />
                    </StackPanel>

                    <!--  No Monitors State with InfoBar  -->
                    <InfoBar
                        x:Name="NoMonitorsInfoBar"
                        x:Uid="NoMonitorsText"
                        IconSource="{ui:FontIconSource Glyph=&#xE7F4;}"
                        IsClosable="False"
                        IsOpen="{x:Bind ViewModel.ShowNoMonitorsMessage, Mode=OneWay}"
                        Severity="Informational" />

                    <!--  Content Area  -->
                    <ScrollViewer
                        Padding="8"
                        HorizontalScrollBarVisibility="Disabled"
                        HorizontalScrollMode="Disabled"
                        VerticalScrollBarVisibility="Auto"
                        ZoomMode="Disabled">
                        <!--  Monitors List with modern card design  -->
                        <ItemsControl
                            HorizontalAlignment="Stretch"
                            ItemsSource="{x:Bind ViewModel.Monitors, Mode=OneWay}"
                            Visibility="{x:Bind ConvertBoolToVisibility(ViewModel.HasMonitors), Mode=OneWay}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate x:DataType="vm:MonitorViewModel">
                                    <StackPanel HorizontalAlignment="Stretch" Spacing="2">
                                        <!--  Monitor Name with Icon  -->
                                        <StackPanel
                                            Padding="12,8"
                                            Orientation="Horizontal"
                                            Spacing="12">
                                            <FontIcon
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                FontSize="14"
                                                Glyph="{x:Bind MonitorIconGlyph, Mode=OneWay}" />
                                            <TextBlock
                                                VerticalAlignment="Center"
                                                FontWeight="SemiBold"
                                                Text="{x:Bind Name, Mode=OneWay}" />
                                        </StackPanel>

                                        <!--  Brightness Control  -->
                                        <Grid HorizontalAlignment="Stretch">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="48" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <FontIcon
                                                Grid.Column="0"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                FontSize="14"
                                                Glyph="&#xE793;" />

                                            <Slider
                                                Grid.Column="1"
                                                MinHeight="32"
                                                Margin="0,2"
                                                HorizontalAlignment="Stretch"
                                                VerticalAlignment="Center"
                                                IsEnabled="{x:Bind IsInteractionEnabled, Mode=OneWay}"
                                                Maximum="{x:Bind MaxBrightness, Mode=OneWay}"
                                                Minimum="{x:Bind MinBrightness, Mode=OneWay}"
                                                PointerCaptureLost="Slider_PointerCaptureLost"
                                                Tag="Brightness"
                                                ValueChanged="Slider_ValueChanged"
                                                Value="{x:Bind Brightness, Mode=OneWay}" />
                                        </Grid>

                                        <!--  Contrast Control  -->
                                        <Grid HorizontalAlignment="Stretch" Visibility="{x:Bind ConvertBoolToVisibility(ShowContrast), Mode=OneWay}">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="48" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>

                                            <FontIcon
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                FontSize="14"
                                                Glyph="&#xE7A6;" />

                                            <Slider
                                                Grid.Column="1"
                                                MinHeight="32"
                                                Margin="0,2"
                                                HorizontalAlignment="Stretch"
                                                VerticalAlignment="Center"
                                                IsEnabled="{x:Bind IsInteractionEnabled, Mode=OneWay}"
                                                Maximum="100"
                                                Minimum="0"
                                                PointerCaptureLost="Slider_PointerCaptureLost"
                                                Tag="Contrast"
                                                ValueChanged="Slider_ValueChanged"
                                                Value="{x:Bind ContrastPercent, Mode=OneWay}" />
                                        </Grid>

                                        <!--  Volume Control  -->
                                        <Grid HorizontalAlignment="Stretch" Visibility="{x:Bind ConvertBoolToVisibility(ShowVolume), Mode=OneWay}">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="48" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>

                                            <FontIcon
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                FontSize="14"
                                                Glyph="&#xE767;" />

                                            <Slider
                                                Grid.Column="1"
                                                MinHeight="32"
                                                Margin="0,2"
                                                HorizontalAlignment="Stretch"
                                                VerticalAlignment="Center"
                                                IsEnabled="{x:Bind IsInteractionEnabled, Mode=OneWay}"
                                                Maximum="{x:Bind MaxVolume, Mode=OneWay}"
                                                Minimum="{x:Bind MinVolume, Mode=OneWay}"
                                                PointerCaptureLost="Slider_PointerCaptureLost"
                                                Tag="Volume"
                                                ValueChanged="Slider_ValueChanged"
                                                Value="{x:Bind Volume, Mode=OneWay}" />
                                        </Grid>
                                    </StackPanel>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Grid>
                <!--  Status Bar with modern design  -->
                <Grid Grid.Row="1" Padding="8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <!--  Status Information  -->
                    <TextBlock x:Name="AdjustBrightnessTextBlock" />

                    <!--  Action Buttons  -->
                    <StackPanel
                        Grid.Column="1"
                        Margin="0,0,12,0"
                        HorizontalAlignment="Right"
                        Orientation="Horizontal"
                        Spacing="8">
                        <Button
                            x:Name="LinkButton"
                            Content="{ui:FontIcon Glyph=&#xE71B;,
                                                  FontSize=16}"
                            Style="{StaticResource SubtleButtonStyle}"
                            ToolTipService.ToolTip="Sync all monitors" />
                        <Button
                            x:Name="DisableButton"
                            Content="{ui:FontIcon Glyph=&#xE7E8;,
                                                  FontSize=16}"
                            Style="{StaticResource SubtleButtonStyle}"
                            ToolTipService.ToolTip="Toggle control" />

                        <Button
                            x:Name="RefreshButton"
                            Content="{ui:FontIcon Glyph=&#xE72C;,
                                                  FontSize=16}"
                            Style="{StaticResource SubtleButtonStyle}"
                            ToolTipService.ToolTip="Refresh monitors" />
                    </StackPanel>
                </Grid>
            </Grid>
        </Border>
    </Grid>
</winuiex:WindowEx>