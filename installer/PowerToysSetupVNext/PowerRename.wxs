<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">

  <?include $(sys.CURRENTDIR)\Common.wxi?>

  <?define PowerRenameAssetsFiles=file.png;folder.png;LargeTile.png;PowerRenameUI.ico;SmallTile.png;SplashScreen.png;Square150x150Logo.png;Square44x44Logo.png;storelogo.png;Wide310x150Logo.pngfile.png;folder.png;LargeTile.png;PowerRenameUI.ico;SmallTile.png;SplashScreen.png;Square150x150Logo.png;Square44x44Logo.png;storelogo.png;Wide310x150Logo.pngfile.png;folder.png;LargeTile.png;PowerRenameUI.ico;SmallTile.png;SplashScreen.png;Square150x150Logo.png;Square44x44Logo.png;storelogo.png;Wide310x150Logo.png?>
  <?define PowerRenameAssetsFilesPath=$(var.BinDir)WinUI3Apps\Assets\PowerRename\?>

  <Fragment>
    <DirectoryRef Id="WinUI3AppsAssetsFolder">
      <Directory Id="PowerRenameAssetsFolder" Name="PowerRename" />
    </DirectoryRef>
    <DirectoryRef Id="PowerRenameAssetsFolder" FileSource="$(var.PowerRenameAssetsFilesPath)">
    <!-- Generated by generateFileComponents.ps1 -->

            <Component Id="PowerRenameAssetsFiles_Component" Win64="yes" Guid="2283E306-7311-40A6-9629-487FDB35B2CB">
              <RegistryKey Root="HKLM" Key="Software\Classes\powertoys\components">
                <RegistryValue Type="string" Name="PowerRenameAssetsFiles_Component" Value="" KeyPath="yes"/>
              </RegistryKey>
              <File Id="PowerRenameAssetsFiles_File_" Source="$(var.PowerRenameAssetsFilesPath)\" />
            </Component>

      <!-- !Warning! Make sure to change Component Guid if you update something here -->
      <Component Id="Module_PowerRename" Guid="40D43079-240E-402D-8CE8-571BFFA71175" Bitness="always64">
        <RegistryKey Root="$(var.RegistryScope)" Key="Software\Classes\CLSID\{0440049F-D1DC-4E46-B27B-98393D79486B}">
          <RegistryValue Type="string" Value="PowerRename Shell Extension" />
          <RegistryValue Type="string" Name="ContextMenuOptIn" Value="" />
          <RegistryValue Type="string" Key="InprocServer32" Value="[WinUI3AppsInstallFolder]PowerToys.PowerRenameExt.dll" />
          <RegistryValue Type="string" Key="InprocServer32" Name="ThreadingModel" Value="Apartment" />
        </RegistryKey>
        <RegistryKey Root="$(var.RegistryScope)" Key="SOFTWARE\Classes\AllFileSystemObjects\ShellEx\ContextMenuHandlers\PowerRenameExt">
          <RegistryValue Type="string" Value="{0440049F-D1DC-4E46-B27B-98393D79486B}" />
        </RegistryKey>
        <RegistryKey Root="$(var.RegistryScope)" Key="SOFTWARE\Classes\Directory\background\ShellEx\ContextMenuHandlers\PowerRenameExt">
          <RegistryValue Type="string" Value="{0440049F-D1DC-4E46-B27B-98393D79486B}" />
        </RegistryKey>

      </Component>
    </DirectoryRef>

    <ComponentGroup Id="PowerRenameComponentGroup">
      <Component Id="RemovePowerRenameFolder" Guid="2028549B-02E3-4D80-BC3F-59AEA37AC73D" Directory="PowerRenameAssetsFolder">
        <RegistryKey Root="$(var.RegistryScope)" Key="Software\Classes\powertoys\components">
          <RegistryValue Type="string" Name="RemovePowerRenameFolder" Value="" KeyPath="yes" />
        </RegistryKey>
        <RemoveFolder Id="RemoveFolderPowerRenameAssetsFolder" Directory="PowerRenameAssetsFolder" On="uninstall" />
      </Component>
      <ComponentRef Id="Module_PowerRename" />
            <ComponentRef Id="PowerRenameAssetsFiles_Component" />
            <ComponentRef Id="PowerRenameAssetsFiles_Component" />
            <ComponentRef Id="PowerRenameAssetsFiles_Component" />
            <ComponentRef Id="PowerRenameAssetsFiles_Component" />
    </ComponentGroup>

  </Fragment>
</Wix>
