<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">

  <?include $(sys.CURRENTDIR)\Common.wxi?>

  <?define SettingsV2AssetsFiles=?>
  <?define SettingsV2AssetsFilesPath=$(var.BinDir)WinUI3Apps\Assets\Settings\?>

  <?define SettingsV2AssetsModulesFiles=?>
  <?define SettingsV2AssetsModulesFilesPath=$(var.BinDir)WinUI3Apps\Assets\Settings\Modules\?>

  <?define SettingsV2OOBEAssetsModulesFiles=?>
  <?define SettingsV2OOBEAssetsModulesFilesPath=$(var.BinDir)WinUI3Apps\Assets\Settings\Modules\OOBE\?>

  <?define SettingsV2OOBEAssetsFluentIconsFiles=?>
  <?define SettingsV2OOBEAssetsFluentIconsFilesPath=$(var.BinDir)WinUI3Apps\Assets\Settings\Icons\?>

  <?define SettingsV2IconsModelsFiles=?>
  <?define SettingsV2IconsModelsFilesPath=$(var.BinDir)WinUI3Apps\Assets\Settings\Icons\Models\?>

  <Fragment>
    <DirectoryRef Id="WinUI3AppsAssetsFolder">
      <Directory Id="SettingsV2AssetsInstallFolder" Name="Settings">
        <Directory Id="SettingsAppAssetsScriptsFolder" Name="Scripts" />
        <Directory Id="SettingsV2OOBEAssetsFluentIconsInstallFolder" Name="Icons">
          <Directory Id="SettingsV2IconsModelsInstallFolder" Name="Models" />
        </Directory>
        <Directory Id="SettingsV2AssetsModulesInstallFolder" Name="Modules">
          <Directory Id="SettingsV2OOBEAssetsModulesInstallFolder" Name="OOBE" />
        </Directory>
      </Directory>
    </DirectoryRef>

    <DirectoryRef Id="SettingsV2AssetsInstallFolder" FileSource="$(var.SettingsV2AssetsFilesPath)">
    <!-- Generated by generateFileComponents.ps1 -->
    <!--SettingsV2AssetsFiles_Component_Def-->
    </DirectoryRef>

    <DirectoryRef Id="SettingsV2AssetsModulesInstallFolder" FileSource="$(var.SettingsV2AssetsModulesFilesPath)">
    <!-- Generated by generateFileComponents.ps1 -->
    <!--SettingsV2AssetsModulesFiles_Component_Def-->
    </DirectoryRef>

    <DirectoryRef Id="SettingsV2OOBEAssetsModulesInstallFolder" FileSource="$(var.SettingsV2OOBEAssetsModulesFilesPath)">
    <!-- Generated by generateFileComponents.ps1 -->
    <!--SettingsV2OOBEAssetsModulesFiles_Component_Def-->
    </DirectoryRef>

    <DirectoryRef Id="SettingsV2OOBEAssetsFluentIconsInstallFolder" FileSource="$(var.SettingsV2OOBEAssetsFluentIconsFilesPath)">
    <!-- Generated by generateFileComponents.ps1 -->
    <!--SettingsV2OOBEAssetsFluentIconsFiles_Component_Def-->
    </DirectoryRef>

    <DirectoryRef Id="SettingsV2IconsModelsInstallFolder" FileSource="$(var.SettingsV2IconsModelsFilesPath)">
    <!-- Generated by generateFileComponents.ps1 -->
    <!--SettingsV2IconsModelsFiles_Component_Def-->
    </DirectoryRef>

    <DirectoryRef Id="SettingsAppAssetsScriptsFolder" FileSource="$(var.SettingsV2AssetsFilesPath)\Scripts\">
      <Component Id="CommandNotFound_Scripts" Guid="898EFA1E-EDD3-4F4B-8C7F-4A14B0D05B02" Bitness="always64">
        <RegistryKey Root="$(var.RegistryScope)" Key="Software\Classes\powertoys\components">
          <RegistryValue Type="string" Name="CommandNotFound_Scripts" Value="" KeyPath="yes" />
        </RegistryKey>
        <File Id="CommandNotFound_Scripts_EnableModule.ps1" Source="$(var.SettingsV2AssetsFilesPath)\Scripts\EnableModule.ps1" />
        <File Id="CommandNotFound_Scripts_UpgradeModule.ps1" Source="$(var.SettingsV2AssetsFilesPath)\Scripts\UpgradeModule.ps1" />
        <File Id="CommandNotFound_Scripts_DisableModule.ps1" Source="$(var.SettingsV2AssetsFilesPath)\Scripts\DisableModule.ps1" />
        <File Id="CommandNotFound_Scripts_CheckCmdNotFoundRequirements.ps1" Source="$(var.SettingsV2AssetsFilesPath)\Scripts\CheckCmdNotFoundRequirements.ps1" />
        <File Id="CommandNotFound_Scripts_InstallWinGetClientModule.ps1" Source="$(var.SettingsV2AssetsFilesPath)\Scripts\InstallWinGetClientModule.ps1" />
        <File Id="CommandNotFound_Scripts_InstallPowerShell7.ps1" Source="$(var.SettingsV2AssetsFilesPath)\Scripts\InstallPowerShell7.ps1" />
      </Component>
    </DirectoryRef>

    <ComponentGroup Id="SettingsComponentGroup">

      <Component Id="RemoveSettingsFolder" Guid="2D3AEF68-4E5A-4FF9-A5C0-9E53391AC754" Directory="SettingsV2AssetsInstallFolder">
        <RegistryKey Root="$(var.RegistryScope)" Key="Software\Classes\powertoys\components">
          <RegistryValue Type="string" Name="RemoveSettingsFolder" Value="" KeyPath="yes" />
        </RegistryKey>
        <RemoveFolder Id="RemoveFolderSettingsV2AssetsInstallFolder" Directory="SettingsV2AssetsInstallFolder" On="uninstall" />
        <RemoveFolder Id="RemoveFolderSettingsV2OOBEAssetsFluentIconsInstallFolder" Directory="SettingsV2OOBEAssetsFluentIconsInstallFolder" On="uninstall" />
        <RemoveFolder Id="RemoveFolderSettingsV2IconsModelsInstallFolder" Directory="SettingsV2IconsModelsInstallFolder" On="uninstall" />
        <RemoveFolder Id="RemoveFolderSettingsV2AssetsModulesInstallFolder" Directory="SettingsV2AssetsModulesInstallFolder" On="uninstall" />
        <RemoveFolder Id="RemoveFolderSettingsV2OOBEAssetsModulesInstallFolder" Directory="SettingsV2OOBEAssetsModulesInstallFolder" On="uninstall" />
        <RemoveFolder Id="RemoveFolderSettingsAppAssetsScriptsFolder" Directory="SettingsAppAssetsScriptsFolder" On="uninstall" />
      </Component>
      <ComponentRef Id="CommandNotFound_Scripts" />
    </ComponentGroup>

  </Fragment>
</Wix>
