<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">

  <?include $(sys.CURRENTDIR)\Common.wxi?>

  <?define FileLocksmithAssetsFiles=AppList.scale-100.png;AppList.scale-125.png;AppList.scale-150.png;AppList.scale-200.png;AppList.scale-400.png;Icon.icoAppList.scale-100.png;AppList.scale-125.png;AppList.scale-150.png;AppList.scale-200.png;AppList.scale-400.png;Icon.icoAppList.scale-100.png;AppList.scale-125.png;AppList.scale-150.png;AppList.scale-200.png;AppList.scale-400.png;Icon.icoAppList.scale-100.png;AppList.scale-125.png;AppList.scale-150.png;AppList.scale-200.png;AppList.scale-400.png;Icon.icoAppList.scale-100.png;AppList.scale-125.png;AppList.scale-150.png;AppList.scale-200.png;AppList.scale-400.png;FileLocksmith.ico;Icon.ico;LargeTile.png;SmallTile.png;SplashScreen.png;Square150x150Logo.png;Square44x44Logo.png;storelogo.png;Wide310x150Logo.pngAppList.scale-100.png;AppList.scale-125.png;AppList.scale-150.png;AppList.scale-200.png;AppList.scale-400.png;FileLocksmith.ico;Icon.ico;LargeTile.png;SmallTile.png;SplashScreen.png;Square150x150Logo.png;Square44x44Logo.png;storelogo.png;Wide310x150Logo.pngAppList.scale-100.png;AppList.scale-125.png;AppList.scale-150.png;AppList.scale-200.png;AppList.scale-400.png;FileLocksmith.ico;Icon.ico;LargeTile.png;SmallTile.png;SplashScreen.png;Square150x150Logo.png;Square44x44Logo.png;storelogo.png;Wide310x150Logo.pngAppList.scale-100.png;AppList.scale-125.png;AppList.scale-150.png;AppList.scale-200.png;AppList.scale-400.png;FileLocksmith.ico;Icon.ico;LargeTile.png;SmallTile.png;SplashScreen.png;Square150x150Logo.png;Square44x44Logo.png;storelogo.png;Wide310x150Logo.pngAppList.scale-100.png;AppList.scale-125.png;AppList.scale-150.png;AppList.scale-200.png;AppList.scale-400.png;FileLocksmith.ico;Icon.ico;LargeTile.png;SmallTile.png;SplashScreen.png;Square150x150Logo.png;Square44x44Logo.png;storelogo.png;Wide310x150Logo.pngAppList.scale-100.png;AppList.scale-125.png;AppList.scale-150.png;AppList.scale-200.png;AppList.scale-400.png;FileLocksmith.ico;Icon.ico;LargeTile.png;SmallTile.png;SplashScreen.png;Square150x150Logo.png;Square44x44Logo.png;storelogo.png;Wide310x150Logo.png?>
  <?define FileLocksmithAssetsFilesPath=$(var.BinDir)WinUI3Apps\Assets\FileLocksmith\?>

  <Fragment>
    <DirectoryRef Id="WinUI3AppsAssetsFolder">
      <Directory Id="FileLocksmithAssetsInstallFolder" Name="FileLocksmith" />
    </DirectoryRef>
    <DirectoryRef Id="FileLocksmithAssetsInstallFolder" FileSource="$(var.FileLocksmithAssetsFilesPath)">
    <!-- Generated by generateFileComponents.ps1 -->

            <Component Id="FileLocksmithAssetsFiles_Component" Win64="yes" Guid="4C8DB4C3-9B77-4022-BEBF-5B9286902087">
              <RegistryKey Root="HKLM" Key="Software\Classes\powertoys\components">
                <RegistryValue Type="string" Name="FileLocksmithAssetsFiles_Component" Value="" KeyPath="yes"/>
              </RegistryKey>
              <File Id="FileLocksmithAssetsFiles_File_AppList.scale_100.png" Source="$(var.FileLocksmithAssetsFilesPath)\AppList.scale-100.png" />
              <File Id="FileLocksmithAssetsFiles_File_AppList.scale_125.png" Source="$(var.FileLocksmithAssetsFilesPath)\AppList.scale-125.png" />
              <File Id="FileLocksmithAssetsFiles_File_AppList.scale_150.png" Source="$(var.FileLocksmithAssetsFilesPath)\AppList.scale-150.png" />
              <File Id="FileLocksmithAssetsFiles_File_AppList.scale_200.png" Source="$(var.FileLocksmithAssetsFilesPath)\AppList.scale-200.png" />
              <File Id="FileLocksmithAssetsFiles_File_AppList.scale_400.png" Source="$(var.FileLocksmithAssetsFilesPath)\AppList.scale-400.png" />
              <File Id="FileLocksmithAssetsFiles_File_FileLocksmith.ico" Source="$(var.FileLocksmithAssetsFilesPath)\FileLocksmith.ico" />
              <File Id="FileLocksmithAssetsFiles_File_Icon.ico" Source="$(var.FileLocksmithAssetsFilesPath)\Icon.ico" />
              <File Id="FileLocksmithAssetsFiles_File_LargeTile.png" Source="$(var.FileLocksmithAssetsFilesPath)\LargeTile.png" />
              <File Id="FileLocksmithAssetsFiles_File_SmallTile.png" Source="$(var.FileLocksmithAssetsFilesPath)\SmallTile.png" />
              <File Id="FileLocksmithAssetsFiles_File_SplashScreen.png" Source="$(var.FileLocksmithAssetsFilesPath)\SplashScreen.png" />
              <File Id="FileLocksmithAssetsFiles_File_Square150x150Logo.png" Source="$(var.FileLocksmithAssetsFilesPath)\Square150x150Logo.png" />
              <File Id="FileLocksmithAssetsFiles_File_Square44x44Logo.png" Source="$(var.FileLocksmithAssetsFilesPath)\Square44x44Logo.png" />
              <File Id="FileLocksmithAssetsFiles_File_storelogo.png" Source="$(var.FileLocksmithAssetsFilesPath)\storelogo.png" />
              <File Id="FileLocksmithAssetsFiles_File_Wide310x150Logo.png" Source="$(var.FileLocksmithAssetsFilesPath)\Wide310x150Logo.png" />
            </Component>

      <!-- !Warning! Make sure to change Component Guid if you update something here -->
      <Component Id="Module_FileLocksmith" Guid="108D3EC1-E6E0-4E81-88EF-25966133CB41" Bitness="always64">
        <RegistryKey Root="$(var.RegistryScope)" Key="Software\Classes\CLSID\{84D68575-E186-46AD-B0CB-BAEB45EE29C0}">
          <RegistryValue Type="string" Value="File Locksmith Shell Extension" />
          <RegistryValue Type="string" Name="ContextMenuOptIn" Value="" />
          <RegistryValue Type="string" Key="InprocServer32" Value="[WinUI3AppsInstallFolder]PowerToys.FileLocksmithExt.dll" />
          <RegistryValue Type="string" Key="InprocServer32" Name="ThreadingModel" Value="Apartment" />
        </RegistryKey>
        <RegistryKey Root="$(var.RegistryScope)" Key="Software\Classes\AllFileSystemObjects\ShellEx\ContextMenuHandlers\FileLocksmithExt">
          <RegistryValue Type="string" Value="{84D68575-E186-46AD-B0CB-BAEB45EE29C0}" />
        </RegistryKey>
        <RegistryKey Root="$(var.RegistryScope)" Key="Software\Classes\Drive\ShellEx\ContextMenuHandlers\FileLocksmithExt">
          <RegistryValue Type="string" Value="{84D68575-E186-46AD-B0CB-BAEB45EE29C0}" />
        </RegistryKey>
      </Component>
    </DirectoryRef>

    <ComponentGroup Id="FileLocksmithComponentGroup">
      <Component Id="RemoveFileLocksmithFolder" Guid="1DAC9A3F-D89C-4730-BF57-1778E011709B" Directory="FileLocksmithAssetsInstallFolder">
        <RegistryKey Root="$(var.RegistryScope)" Key="Software\Classes\powertoys\components">
          <RegistryValue Type="string" Name="RemoveFileLocksmithFolder" Value="" KeyPath="yes" />
        </RegistryKey>
        <RemoveFolder Id="RemoveFolderFileLocksmithAssetsFolder" Directory="FileLocksmithAssetsInstallFolder" On="uninstall" />
      </Component>
      <ComponentRef Id="Module_FileLocksmith" />
            <ComponentRef Id="FileLocksmithAssetsFiles_Component" />
            <ComponentRef Id="FileLocksmithAssetsFiles_Component" />
            <ComponentRef Id="FileLocksmithAssetsFiles_Component" />
            <ComponentRef Id="FileLocksmithAssetsFiles_Component" />
            <ComponentRef Id="FileLocksmithAssetsFiles_Component" />
            <ComponentRef Id="FileLocksmithAssetsFiles_Component" />
            <ComponentRef Id="FileLocksmithAssetsFiles_Component" />
            <ComponentRef Id="FileLocksmithAssetsFiles_Component" />
            <ComponentRef Id="FileLocksmithAssetsFiles_Component" />
            <ComponentRef Id="FileLocksmithAssetsFiles_Component" />
    </ComponentGroup>

  </Fragment>
</Wix>
