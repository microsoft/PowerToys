<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">

  <?include $(sys.CURRENTDIR)\Common.wxi?>

  <?define ColorPickerAssetsFiles=?>
  <?define ColorPickerAssetsFilesPath=$(var.BinDir)Assets\ColorPicker\?>

  <Fragment>
  <!-- Color Picker -->
    <DirectoryRef Id="BaseApplicationsAssetsFolder">
      <Directory Id="ColorPickerAssetsFolder" Name="ColorPicker" />
    </DirectoryRef>
    <!-- Color Picker Resources -->
    <DirectoryRef Id="ColorPickerAssetsFolder" FileSource="$(var.ColorPickerAssetsFilesPath)">
    <!-- Generated by generateFileComponents.ps1 -->
    <!--ColorPickerAssetsFiles_Component_Def-->
    </DirectoryRef>

    <ComponentGroup Id="ColorPickerComponentGroup">
      <Component Id="RemoveColorPickerFolder" Guid="18C0C18C-F38A-4C88-B22C-9222F3A5B2EB" Directory="INSTALLFOLDER">
        <RegistryKey Root="$(var.RegistryScope)" Key="Software\Classes\powertoys\components">
          <RegistryValue Type="string" Name="RemoveColorPickerFolder" Value="" KeyPath="yes" />
        </RegistryKey>
        <RemoveFolder Id="RemoveFolderColorPickerAssetsFolder" Directory="ColorPickerAssetsFolder" On="uninstall" />
      </Component>
    </ComponentGroup>

  </Fragment>
</Wix>
