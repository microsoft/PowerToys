<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:util="http://schemas.microsoft.com/wix/UtilExtension" >

    <!-- Names of folders and projects -->
    <?define FancyZonesProjectName="FancyZones"?>
    <?define ImageResizerProjectName="ImageResizer"?>
    <?define KeyboardManagerProjectName="KeyboardManager"?>
    <?define PowerRenameProjectName="PowerRename"?>
    <?define ColorPickerProjectName="ColorPicker"?>
    <?define VideoConferenceProjectName="VideoConference"?>
    <?define AwakeProjectName="Awake"?>
    <?define MouseUtilsProjectName="MouseUtils"?>
    <?define AlwaysOnTopProjectName="AlwaysOnTop"?>

    <?define RepoDir="$(var.ProjectDir)..\..\" ?>
    <?define BinX32Dir="$(var.RepoDir)x86\$(var.Configuration)\" ?>
    <?define BinX64Dir="$(var.RepoDir)x64\$(var.Configuration)\" ?>
    <?define ShortcutGuideExecutable=$(var.BinX64Dir)\modules\ShortcutGuide\ShortcutGuide?>
    <?define ShortcutGuideModuleInterface=$(var.BinX64Dir)\modules\ShortcutGuide\ShortcutGuideModuleInterface?>

    <Product Id="*"
       Name="PowerToys (Preview)"
       Language="1033"
       Version="$(var.Version)"
       Manufacturer="Microsoft Corporation"
       UpgradeCode="42B84BF7-5FBF-473B-9C8B-049DC16F7708">

        <Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" InstallPrivileges="elevated" Platform="x64" />

        <MajorUpgrade DowngradeErrorMessage="A later version of [ProductName] is already installed." />

        <Upgrade Id="42B84BF7-5FBF-473B-9C8B-049DC16F7708">
            <UpgradeVersion
               Minimum="0.0.0" Maximum="$(var.Version)"
               Property="PREVIOUSVERSIONSINSTALLED"
               IncludeMinimum="yes" IncludeMaximum="no" />
        </Upgrade>

        <MediaTemplate EmbedCab="yes" />

        <Property Id="WINDOWSBUILDNUMBER" Secure="yes">
            <RegistrySearch Id="BuildNumberSearch" Root="HKLM" Key="SOFTWARE\Microsoft\Windows NT\CurrentVersion" Name="CurrentBuildNumber" Type="raw" />
        </Property>
        <Condition Message="This application is only supported on Windows 10 version 1903 (build 18362) or higher.">
            <![CDATA[(WINDOWSBUILDNUMBER >= 18362)]]>
        </Condition>

        <Icon Id="powertoys.exe" SourceFile="$(var.BinX64Dir)svgs\icon.ico"/>
        <Property Id="ARPPRODUCTICON" Value="powertoys.exe" />
        <Feature Id="CoreFeature" Title="PowerToys" AllowAdvertise="no" Absent="disallow" TypicalDefault="install"
                 Description="Contains the Shortcut Guide and Fancy Zones features.">
            <ComponentGroupRef Id="CoreComponents" />
            <ComponentGroupRef Id="ResourcesComponents" />
            <ComponentGroupRef Id="LauncherComponents" />
            <ComponentGroupRef Id="ToolComponents" />
            <ComponentGroupRef Id="MonacoSRCHeatGenerated" />
        </Feature>
        <SetProperty Id="ARPINSTALLLOCATION" Value="[INSTALLFOLDER]" After="CostFinalize" />

        <Property Id="WIXUI_INSTALLDIR" Value="INSTALLFOLDER" />
        <UI>
            <UIRef Id="WixUI_InstallDir"/>
            <Publish Dialog="WelcomeDlg"
                      Control="Next"
                      Event="NewDialog"
                      Value="InstallDirDlg"
                      Order="99">1</Publish>
            <Publish Dialog="InstallDirDlg"
                      Control="Back"
                      Event="NewDialog"
                      Value="WelcomeDlg"
                      Order="99">1</Publish>

            <Publish Dialog="ExitDialog"
                  Control="Finish"
                  Event="EndDialog"
                  Value="Return">NOT Installed</Publish>
            <Publish Dialog="MaintenanceTypeDlg" Control="RemoveButton" Property="_REMOVE_ALL" Value="Yes">1</Publish>
            <Publish Dialog="UserExit" Control="Finish" Event="DoAction" Value="TelemetryLogInstallCancel">NOT Installed</Publish>
            <Publish Dialog="FatalError" Control="Finish" Event="DoAction" Value="TelemetryLogInstallFail">NOT Installed</Publish>
            <Publish Dialog="UserExit" Control="Finish" Event="DoAction" Value="TelemetryLogUninstallCancel">Installed AND _REMOVE_ALL="Yes"</Publish>
            <Publish Dialog="FatalError" Control="Finish" Event="DoAction" Value="TelemetryLogUninstallFail">Installed AND _REMOVE_ALL="Yes"</Publish>
            <Publish Dialog="UserExit" Control="Finish" Event="DoAction" Value="TelemetryLogRepairCancel">Installed AND NOT (_REMOVE_ALL="Yes")</Publish>
            <Publish Dialog="FatalError" Control="Finish" Event="DoAction" Value="TelemetryLogRepairFail">Installed AND NOT (_REMOVE_ALL="Yes")</Publish>
        </UI>
        <WixVariable Id="WixUIBannerBmp" Value="$(var.ProjectDir)\Images\banner.png" />
        <WixVariable Id="WixUIDialogBmp" Value="$(var.ProjectDir)\Images\dialog.png" />
        <WixVariable Id="WixUILicenseRtf" Value="$(var.RepoDir)\installer\License.rtf" />
        <Property Id="INSTALLSTARTMENUSHORTCUT" Value="1"/>
        <Property Id="CREATESCHEDULEDTASK" Value="1"/>
        <Property Id="WixShellExecTarget" Value="[#PowerToys_ActionRunner.exe]" />

        <SetProperty Action="SetDEFAULTBOOTSTRAPPERINSTALLFOLDER" Id="DEFAULTBOOTSTRAPPERINSTALLFOLDER" Value="[ProgramFiles64Folder]PowerToys" Before="SetBOOTSTRAPPERINSTALLFOLDER" Sequence="execute">
        </SetProperty>
        <!-- In case we didn't receive a value from the bootstrapper. -->
        <SetProperty Action="SetBOOTSTRAPPERINSTALLFOLDER" Id="BOOTSTRAPPERINSTALLFOLDER" Value="[DEFAULTBOOTSTRAPPERINSTALLFOLDER]" Before="DetectPrevInstallPath" Sequence="execute">
          <![CDATA[BOOTSTRAPPERINSTALLFOLDER = ""]]>
        </SetProperty>
        <!-- Have to compare value sent by bootstrapper to default to avoid using it, as a check to verify it's not default. This hack can be removed if it's possible to set the bootstrapper option to the previous install folder -->
        <SetProperty Action="SetINSTALLFOLDERTOPREVIOUSINSTALLFOLDER" Id="INSTALLFOLDER" Value="[PREVIOUSINSTALLFOLDER]" After="DetectPrevInstallPath" Sequence="execute">
          <![CDATA[BOOTSTRAPPERINSTALLFOLDER = DEFAULTBOOTSTRAPPERINSTALLFOLDER AND PREVIOUSINSTALLFOLDER <> ""]]>
        </SetProperty>
        <SetProperty Action="SetINSTALLFOLDERTOBOOTSTRAPPERINSTALLFOLDER" Id="INSTALLFOLDER" Value="[BOOTSTRAPPERINSTALLFOLDER]" After="DetectPrevInstallPath" Sequence="execute">
          <![CDATA[BOOTSTRAPPERINSTALLFOLDER <> DEFAULTBOOTSTRAPPERINSTALLFOLDER OR PREVIOUSINSTALLFOLDER = ""]]>
        </SetProperty>

        <InstallExecuteSequence>
            <Custom Action="DetectPrevInstallPath" After="AppSearch" />
            <Custom Action="SetRegisterPowerToysSchTaskParam" Before="RegisterPowerToysSchTask" />
            <Custom Action="SetApplyModulesRegistryChangeSetsParam" Before="ApplyModulesRegistryChangeSets" />
            <Custom Action="SetUnApplyModulesRegistryChangeSetsParam" Before="UnApplyModulesRegistryChangeSets" />
            <Custom Action="RegisterPowerToysSchTask" After="InstallFiles">
                NOT Installed and CREATESCHEDULEDTASK = 1
            </Custom>
            <Custom Action="ApplyModulesRegistryChangeSets" After="InstallFiles">
                NOT Installed
            </Custom>
            <Custom Action="WixCloseApplications" Before="RemoveFiles" />
            <Custom Action="RemovePowerToysSchTasks" After="RemoveFiles" />
            <!-- TODO: Use to activate embedded MSIX -->
            <!--<Custom Action="InstallEmbeddedMSIXTask" After="InstallFinalize">
        NOT Installed
      </Custom>-->
            <Custom Action="TelemetryLogInstallSuccess" After="InstallFinalize">
                NOT Installed
            </Custom>
            <Custom Action="TelemetryLogUninstallSuccess" After="InstallFinalize">
                Installed and (NOT UPGRADINGPRODUCTCODE) AND (REMOVE="ALL")
            </Custom>
            <Custom Action="UnApplyModulesRegistryChangeSets" Before="RemoveFiles">
                Installed AND (REMOVE="ALL")
            </Custom>

            <!-- TODO: Use to activate embedded MSIX -->
            <!--<Custom Action="UninstallEmbeddedMSIXTask" After="InstallFinalize">
        Installed AND (REMOVE="ALL")
      </Custom>-->
            <Custom Action="TerminateProcesses" Before="InstallValidate" />

            <Custom Action="LaunchPowerToys" After="InstallFinalize">NOT Installed</Custom>

        </InstallExecuteSequence>

        <CustomAction
          Id="LaunchPowerToys"
          Execute="immediate"
          Impersonate="yes"
          Return="asyncNoWait"
          FileKey="PowerToys.exe"
          ExeCommand="" />

        <CustomAction
          Id="TerminateProcesses"
          Return="ignore"
          Execute="immediate"
          BinaryKey="PTCustomActions"
          DllEntry="TerminateProcessesCA" />

        <CustomAction Id="SetRegisterPowerToysSchTaskParam"
                      Property="RegisterPowerToysSchTask"
                      Value="[INSTALLFOLDER]PowerToys.exe" />

        <CustomAction Id="SetApplyModulesRegistryChangeSetsParam"
                        Property="ApplyModulesRegistryChangeSets"
                        Value="[INSTALLFOLDER]" />

        <CustomAction Id="SetUnApplyModulesRegistryChangeSetsParam"
                        Property="UnApplyModulesRegistryChangeSets"
                        Value="[INSTALLFOLDER]" />

        <!-- Needs to Impersonate="no" and Execute="deferred" in order to run elevated. -->
        <CustomAction Id="RegisterPowerToysSchTask"
                      Return="ignore"
                      Impersonate="no"
                      Execute="deferred"
                      BinaryKey="PTCustomActions"
                      DllEntry="CreateScheduledTaskCA"
                   />

        <CustomAction Id="RemovePowerToysSchTasks"
                      Return="ignore"
                      Impersonate="no"
                      Execute="deferred"
                      BinaryKey="PTCustomActions"
                      DllEntry="RemoveScheduledTasksCA"
                   />

        <CustomAction Id="InstallEmbeddedMSIXTask"
                      Return="ignore"
                      Impersonate="yes"
                      BinaryKey="PTCustomActions"
                      DllEntry="InstallEmbeddedMSIXCA"
                   />

        <CustomAction Id="UninstallEmbeddedMSIXTask"
                      Return="ignore"
                      Impersonate="yes"
                      BinaryKey="PTCustomActions"
                      DllEntry="UninstallEmbeddedMSIXCA"
                   />

        <CustomAction Id="TelemetryLogInstallSuccess"
                  Return="ignore"
                  Impersonate="yes"
                  BinaryKey="PTCustomActions"
                  DllEntry="TelemetryLogInstallSuccessCA"
                   />

        <CustomAction Id="TelemetryLogInstallCancel"
                      Return="ignore"
                      Impersonate="yes"
                      BinaryKey="PTCustomActions"
                      DllEntry="TelemetryLogInstallCancelCA"
                   />

        <CustomAction Id="TelemetryLogInstallFail"
                      Return="ignore"
                      Impersonate="yes"
                      BinaryKey="PTCustomActions"
                      DllEntry="TelemetryLogInstallFailCA"
                   />

        <CustomAction Id="TelemetryLogUninstallSuccess"
                      Return="ignore"
                      Impersonate="yes"
                      BinaryKey="PTCustomActions"
                      DllEntry="TelemetryLogUninstallSuccessCA"
                   />

        <CustomAction Id="TelemetryLogUninstallCancel"
                      Return="ignore"
                      Impersonate="yes"
                      BinaryKey="PTCustomActions"
                      DllEntry="TelemetryLogUninstallCancelCA"
                   />

        <CustomAction Id="TelemetryLogUninstallFail"
                      Return="ignore"
                      Impersonate="yes"
                      BinaryKey="PTCustomActions"
                      DllEntry="TelemetryLogUninstallFailCA"
                   />

        <CustomAction Id="TelemetryLogRepairCancel"
                      Return="ignore"
                      Impersonate="yes"
                      BinaryKey="PTCustomActions"
                      DllEntry="TelemetryLogRepairCancelCA"
                   />

        <CustomAction Id="TelemetryLogRepairFail"
                      Return="ignore"
                      Impersonate="yes"
                      BinaryKey="PTCustomActions"
                      DllEntry="TelemetryLogRepairFailCA"
                   />

        <CustomAction Id="DetectPrevInstallPath"
                      Return="check"
                      Impersonate="yes"
                      BinaryKey="PTCustomActions"
                      DllEntry="DetectPrevInstallPathCA"
                  />

        <CustomAction Id="ApplyModulesRegistryChangeSets"
                      Return="check"
                      Impersonate="yes"
                      Execute="deferred"
                      BinaryKey="PTCustomActions"
                      DllEntry="ApplyModulesRegistryChangeSetsCA"
                  />

        <CustomAction Id="UnApplyModulesRegistryChangeSets"
                      Return="check"
                      Impersonate="yes"
                      Execute="deferred"
                      BinaryKey="PTCustomActions"
                      DllEntry="UnApplyModulesRegistryChangeSetsCA"
                  />


        <!-- Close 'PowerToys.exe' before uninstall-->
        <Property Id="MSIRESTARTMANAGERCONTROL" Value="DisableShutdown" />
        <Property Id="MSIFASTINSTALL" Value="DisableShutdown" />
        <util:CloseApplication CloseMessage="yes" Target="PowerToys.exe" ElevatedCloseMessage="yes" RebootPrompt="no" TerminateProcess="0" />
    </Product>

    <Fragment>
        <Binary Id="PTCustomActions" SourceFile="$(var.PowerToysSetupCustomActions.TargetPath)" />
    </Fragment>

    <Fragment>
        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="ProgramFiles64Folder">
                <Directory Id="INSTALLFOLDER" Name="PowerToys">
                    <Directory Id="ToolsFolder" Name="Tools"/>
                    <Directory Id="ModulesInstallFolder" Name="modules">
                        <Directory Id="ImageResizerInstallFolder" Name="$(var.ImageResizerProjectName)" />
                        <Directory Id="PowerRenameInstallFolder" Name="$(var.PowerRenameProjectName)">
                            <Directory Id="PowerRenameAssetsFolder" Name="Assets" />
                        </Directory>
                        <Directory Id="ShortcutGuideInstallFolder" Name="ShortcutGuide">
                            <Directory Id="ShortcutGuideExecutableInstallFolder" Name="ShortcutGuide">
                                <Directory Id="ShortcutGuideSvgsInstallFolder" Name="svgs"/>
                            </Directory>
                            <Directory Id="ShortcutGuideModuleInterfaceInstallFolder" Name="ShortcutGuideModuleInterface"/>
                        </Directory>
                        <Directory Id="VideoConferenceInstallFolder" Name="$(var.VideoConferenceProjectName)">
                            <Directory Id="VideoConferenceIconsFolder" Name="Icons" />
                        </Directory>
                        <Directory Id="FileExplorerPreviewInstallFolder" Name="FileExplorerPreview">
                            <Directory Id="MonacoPreviewHandlerMonacoSRCFolder" Name="monacoSRC" />
                            <Directory Id="MonacoPreviewHandlerRuntimesFolder" Name="runtimes">
                                <Directory Id="MonacoPreviewHandlerRuntimesWinX64Folder" Name="win-x64">
                                    <Directory Id="MonacoPreviewHandlerRuntimesWinX64NativeFolder" Name="native" />
                                </Directory>
                            </Directory>
                        </Directory>
                        <Directory Id="FancyZonesInstallFolder" Name="$(var.FancyZonesProjectName)" />
                        <Directory Id="AwakeInstallFolder" Name="$(var.AwakeProjectName)">
                            <Directory Id="AwakeImagesFolder" Name="Images" />
                            <Directory Id="AwakeInstallFolderRuntimes" Name="Runtimes">
                                <Directory Id="AwakeInstallFolderRuntimesWin" Name="Win">
                                    <Directory Id="AwakeInstallFolderRuntimesWinLib" Name="Lib">
                                        <Directory Id="AwakeInstallFolderNetcoreApp21" Name="netcoreapp2.1" />
                                        <Directory Id="AwakeInstallFolderNetcoreApp30" Name="netcoreapp3.0" />
                                        <Directory Id="AwakeInstallFolderNetStandard20" Name="netstandard2.0" />
                                    </Directory>
                                </Directory>
                            </Directory>
                        </Directory>

                        <!-- KBM -->
                        <Directory Id="KeyboardManagerInstallFolder" Name="$(var.KeyboardManagerProjectName)">
                            <Directory Id="KeyboardManagerEditorInstallFolder" Name="KeyboardManagerEditor" />
                            <Directory Id="KeyboardManagerEngineInstallFolder" Name="KeyboardManagerEngine" />
                        </Directory>

                        <!-- Color Picker -->
                        <Directory Id="ColorPickerInstallFolder" Name="$(var.ColorPickerProjectName)">
                            <Directory Id="ColorPickerResourcesFolder" Name="Resources"/>
                        </Directory>

                        <!-- Mouse Utils -->
                        <Directory Id="MouseUtilsInstallFolder" Name="$(var.MouseUtilsProjectName)">
                        </Directory>

                        <!-- AlwaysOnTop -->
                        <Directory Id="AlwaysOnTopInstallFolder" Name="$(var.AlwaysOnTopProjectName)">
                        </Directory>

                        <!-- Launcher -->
                        <Directory Id="LauncherInstallFolder" Name="launcher">
                            <Directory Id="LauncherImagesFolder" Name="Images" />
                            <Directory Id="LauncherPropertiesFolder" Name="Properties" />

                            <!-- Plugins -->
                            <Directory Id="LauncherPluginsFolder" Name="Plugins">
                                <Directory Id="WebSearchPluginFolder" Name="WebSearch">
                                    <Directory Id="WebSearchImagesFolder" Name="Images" />
                                    <Directory Id="WebSearchLanguagesFolder" Name="Languages" />
                                </Directory>
                                <Directory Id="CalculatorPluginFolder" Name="Calculator">
                                    <Directory Id="CalculatorImagesFolder" Name="Images" />
                                    <Directory Id="CalculatorLanguagesFolder" Name="Languages" />
                                </Directory>
                                <Directory Id="FolderPluginFolder" Name="Folder">
                                    <Directory Id="FolderPluginImagesFolder" Name="Images" />
                                    <Directory Id="FolderPluginLanguagesFolder" Name="Languages" />
                                </Directory>
                                <Directory Id="ProgramPluginFolder" Name="Program">
                                    <Directory Id="ProgramImagesFolder" Name="Images" />
                                    <Directory Id="ProgramLanguagesFolder" Name="Languages" />
                                </Directory>
                                <Directory Id="ShellPluginFolder" Name="Shell">
                                    <Directory Id="ShellImagesFolder" Name="Images" />
                                    <Directory Id="ShellLanguagesFolder" Name="Languages" />
                                </Directory>
                                <Directory Id="IndexerPluginFolder" Name="Indexer">
                                    <Directory Id="IndexerImagesFolder" Name="Images" />
                                    <Directory Id="IndexerLanguagesFolder" Name="Languages" />
                                </Directory>
                                <Directory Id="UriPluginFolder" Name="Uri">
                                    <Directory Id="UriImagesFolder" Name="Images" />
                                    <Directory Id="UriLanguagesFolder" Name="Languages" />
                                </Directory>
                                <Directory Id="UnitConverterPluginFolder" Name="UnitConverter">
                                    <Directory Id="UnitConverterImagesFolder" Name="Images" />
                                    <Directory Id="UnitConverterLanguagesFolder" Name="Languages" />
                                </Directory>
                                <Directory Id="VSCodeWorkspacesPluginFolder" Name="VSCodeWorkspace">
                                    <Directory Id="VSCodeWorkspaceImagesFolder" Name="Images" />
                                    <Directory Id="VSCodeWorkspaceLanguagesFolder" Name="Languages" />
                                </Directory>
                                <Directory Id="WindowWalkerPluginFolder" Name="WindowWalker">
                                    <Directory Id="WindowWalkerImagesFolder" Name="Images" />
                                    <Directory Id="WindowWalkerLanguagesFolder" Name="Languages" />
                                </Directory>
                                <Directory Id="RegistryPluginFolder" Name="Registry">
                                    <Directory Id="RegistryImagesFolder" Name="Images" />
                                    <Directory Id="RegistryLanguagesFolder" Name="Languages" />
                                </Directory>
                                <Directory Id="ServicePluginFolder" Name="Service">
                                    <Directory Id="ServiceImagesFolder" Name="Images" />
                                </Directory>
                                <Directory Id="WindowsTerminalPluginFolder" Name="WindowsTerminal">
                                    <Directory Id="WindowsTerminalImagesFolder" Name="Images" />
                                </Directory>
                                <Directory Id="SystemPluginFolder" Name="System">
                                    <Directory Id="SystemImagesFolder" Name="Images" />
                                </Directory>
                                <Directory Id="WindowsSettingsPluginFolder" Name="WindowsSettings">
                                    <Directory Id="WindowsSettingsImagesFolder" Name="Images" />
                                    <Directory Id="WindowsSettingsLanguagesFolder" Name="Languages" />
                                </Directory>
                            </Directory>
                        </Directory>
                    </Directory>

                    <!-- Settings -->
                    <Directory Id="SettingsV2InstallFolder" Name="Settings">
                        <Directory Id="SettingsV2ViewsInstallFolder" Name="Views"/>
                        <Directory Id="SettingsV2StylesInstallFolder" Name="Styles"/>
                        <Directory Id="SettingsV2PropertiesInstallFolder" Name="Properties"/>
                        <Directory Id="SettingsV2AssetsInstallFolder" Name="Assets">
                            <Directory Id="SettingsV2OOBEAssetsFluentIconsInstallFolder" Name="FluentIcons" />
                            <Directory Id="SettingsV2AssetsModulesInstallFolder" Name="Modules" >
                                <Directory Id="SettingsV2OOBEAssetsModulesInstallFolder" Name="OOBE" />
                            </Directory>
                        </Directory>
                        <Directory Id="SettingsV2ControlsInstallFolder" Name="Controls"/>
                        <Directory Id="SettingsV2XamlInstallFolder" Name="Microsoft.UI.Xaml">
                            <Directory Id="SettingsV2XamlAssetsInstallFolder" Name="Assets" />
                        </Directory>
                    </Directory>
                </Directory>
            </Directory>
            <Directory Id="ProgramMenuFolder">
                <Directory Id="ApplicationProgramsFolder" Name="PowerToys (Preview)"/>
            </Directory>
            <Directory Id="DesktopFolder" Name="Desktop" />
        </Directory>
    </Fragment>

    <Fragment>
        <DirectoryRef Id="INSTALLFOLDER" FileSource="$(var.BinX64Dir)">
            <Component Id="powertoys_toast_clsid" Win64="yes" Guid="78D30568-E735-435D-9E08-59CDA1DC6555">
                <RemoveFolder Id='Remove_powertoys_toast_clsid' On='uninstall' />
                <RegistryKey Root="HKCR" Key="Software\Classes\CLSID\{DD5CACDA-7C2E-4997-A62A-04A597B58F76}">
                    <RegistryValue Type="string" Value="PowerToys Toast Notifications Background Activator" />
                    <RegistryValue Type="string" Key="LocalServer32" Value="[INSTALLFOLDER]PowerToys.exe -ToastActivated" />
                    <RegistryValue Type="string" Key="LocalServer32" Name="ThreadingModel" Value="Apartment" />
                </RegistryKey>
            </Component>
            <Component Id="powertoys_exe" Guid="A2C66D91-3485-4D00-B04D-91844E6B345B" Win64="yes">
                <File Id="PowerToys.exe" KeyPath="yes" Checksum="yes" />
                <RegistryKey Root="HKLM" Key="Software\Classes\powertoys">
                    <RegistryValue Type="string" Name="URL Protocol" Value=""/>
                    <RegistryValue Type="string" Value="URL:PowerToys custom internal URI protocol"/>
                    <RegistryKey Key="DefaultIcon">
                        <RegistryValue Type="string" Value="PowerToys.exe" />
                    </RegistryKey>
                    <RegistryKey Key="shell\open\command">
                        <RegistryValue Type="string" Value="&quot;[INSTALLFOLDER]PowerToys.exe&quot; &quot;%1&quot;" />
                    </RegistryKey>
                </RegistryKey>
            </Component>
            <Component Id="BackgroundActivator_dll" Guid="23B25EE4-BCA2-45DF-BBCD-82FBDF01C5AB" Win64="yes">
                <File Id="PowerToys.BackgroundActivatorDLL.dll" KeyPath="yes" Checksum="yes" />
            </Component>
            <Component Id="PowerToys_ActionRunner_exe" Guid="626ABB17-16F0-4007-9A58-6998724A5E14" Win64="yes">
                <File Id="PowerToys.ActionRunner.exe" KeyPath="yes" Checksum="yes" />
            </Component>
            <Component Id="PowerToys_Update_exe" Guid="446D0AD4-AA8F-45BA-BDAC-6C620DF77AFF" Win64="yes">
                <File Id="PowerToys.Update.exe" KeyPath="yes" Checksum="yes" />
            </Component>
            <Component Id="License_rtf" Guid="3E5AE43B-CFB4-449B-A346-94CAAFF3312E" Win64="yes">
                <File Source="$(var.RepoDir)\installer\License.rtf" Id="License.rtf" KeyPath="yes" />
            </Component>
            <Component Id="Notice_md" Guid="E2FE99F5-5DF7-44EA-8B1C-2BDF8CEC5E6D" Win64="yes">
                <File Source="$(var.RepoDir)\Notice.md" Id="Notice.md" KeyPath="yes" />
            </Component>
            <Component Id="powertoysinterop_dll" Guid="B7DD2DF4-C8F2-46FA-9571-D6EF1588ADF3" Win64="yes">
                <File Id="PowerToys.Interop.dll" KeyPath="yes" Checksum="yes" />
            </Component>
            <Component Id="vcredist_dlls" Guid="CBE26CB0-3AD0-4336-A7D6-503046BADEBC" Win64="yes">
                <!-- VCRuntime -->
                <?foreach File in vcruntime140.dll;vcruntime140_1.dll;concrt140.dll;msvcp140.dll;msvcp140_1.dll;msvcp140_2.dll;msvcp140_codecvt_ids.dll;vccorlib140.dll?>
                <File Id="$(var.File)" Source="$(var.RepoDir)installer\VCRuntime\$(var.File)" />
                <?endforeach?>
            </Component>
        </DirectoryRef>

        <DirectoryRef Id="ApplicationProgramsFolder">
            <Component Id="PowerToysStartMenuShortcut" Guid="336AB4F9-078C-4DCA-B69F-3808A9FFD758">
                <Shortcut Id="ApplicationStartMenuShortcut"
                Name="PowerToys (Preview)"
                Description="PowerToys - Windows system utilities to maximize productivity"
                Icon="powertoys.exe"
                IconIndex="0"
                Target="[!PowerToys.exe]"
                WorkingDirectory="INSTALLFOLDER">
                    <ShortcutProperty Key="System.AppUserModel.ID" Value="Microsoft.PowerToysWin32"/>
                </Shortcut>
                <RemoveFolder Id="CleanUpStartMenuShortCut" Directory="ApplicationProgramsFolder" On="uninstall"/>
                <!-- ApplicationStartMenuShortcut is implicitly installed in HKCU, so WIX won't allow changing this reg value to HKLM. -->
                <RegistryValue Root="HKCU" Key="Software\Microsoft\PowerToys" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
            </Component>
        </DirectoryRef>

        <!-- Shortcut guide files -->
        <DirectoryRef Id="ShortcutGuideSvgsInstallFolder" FileSource="$(var.ShortcutGuideExecutable)\svgs\">
            <Component Id="ShortcutGuideSvgs" Guid="7C4D4EED-9338-423D-992C-DCE02F3E2D35" Win64="yes">
                <File Source="$(var.ShortcutGuideExecutable)\svgs\0.svg" />
                <File Source="$(var.ShortcutGuideExecutable)\svgs\1.svg" />
                <File Source="$(var.ShortcutGuideExecutable)\svgs\2.svg" />
                <File Source="$(var.ShortcutGuideExecutable)\svgs\3.svg" />
                <File Source="$(var.ShortcutGuideExecutable)\svgs\4.svg" />
                <File Source="$(var.ShortcutGuideExecutable)\svgs\5.svg" />
                <File Source="$(var.ShortcutGuideExecutable)\svgs\6.svg" />
                <File Source="$(var.ShortcutGuideExecutable)\svgs\7.svg" />
                <File Source="$(var.ShortcutGuideExecutable)\svgs\8.svg" />
                <File Source="$(var.ShortcutGuideExecutable)\svgs\9.svg" />
                <File Source="$(var.ShortcutGuideExecutable)\svgs\no_active_window.svg" />
                <File Source="$(var.ShortcutGuideExecutable)\svgs\overlay.svg" />
                <File Source="$(var.ShortcutGuideExecutable)\svgs\overlay_portrait.svg" />
            </Component>
        </DirectoryRef>

        <!-- FancyZone -->
        <DirectoryRef Id="FancyZonesInstallFolder" FileSource="$(var.BinX64Dir)modules\">
            <Component Id="Module_FancyZones" Guid="C6B5272E-6ED4-4B80-B0E7-2FF0355D8CF4" Win64="yes">
                <File Source="$(var.BinX64Dir)modules\$(var.FancyZonesProjectName)\PowerToys.FancyZonesModuleInterface.dll" KeyPath="yes" />
                <File Source="$(var.BinX64Dir)modules\$(var.FancyZonesProjectName)\PowerToys.FancyZonesEditor.dll" />
                <File Source="$(var.BinX64Dir)modules\$(var.FancyZonesProjectName)\PowerToys.FancyZonesEditor.runtimeconfig.json" />
                <File Source="$(var.BinX64Dir)modules\$(var.FancyZonesProjectName)\PowerToys.FancyZonesEditor.deps.json" />
                <File Source="$(var.BinX64Dir)modules\$(var.FancyZonesProjectName)\PowerToys.FancyZonesEditor.exe" />
                <File Source="$(var.BinX64Dir)modules\$(var.FancyZonesProjectName)\PowerToys.FancyZones.exe" />
                <File Source="$(var.BinX64Dir)modules\$(var.FancyZonesProjectName)\ControlzEx.dll" />
                <File Source="$(var.BinX64Dir)modules\$(var.FancyZonesProjectName)\Microsoft.Xaml.Behaviors.dll" />
                <File Source="$(var.BinX64Dir)modules\$(var.FancyZonesProjectName)\ModernWpf.dll" />
                <File Source="$(var.BinX64Dir)modules\$(var.FancyZonesProjectName)\ModernWpf.Controls.dll" />
                <File Source="$(var.BinX64Dir)modules\$(var.FancyZonesProjectName)\System.Text.Json.dll" />

                <File Id="FancyZones_interop" Source="$(var.BinX64Dir)modules\$(var.FancyZonesProjectName)\PowerToys.Interop.dll" />
                <File Id="FancyZones_ManagedCommon" Source="$(var.BinX64Dir)modules\$(var.FancyZonesProjectName)\PowerToys.ManagedCommon.dll" />
                <File Id="FancyZones_Common.UI" Source="$(var.BinX64Dir)modules\$(var.FancyZonesProjectName)\PowerToys.Common.UI.dll" />
                <File Id="FancyZones_Telemetry.dll" Source="$(var.BinX64Dir)modules\$(var.FancyZonesProjectName)\PowerToys.ManagedTelemetry.dll" />
                <File Id="FancyZone_System.IO.Abstractions.dll" Source="$(var.BinX64Dir)modules\$(var.FancyZonesProjectName)\System.IO.Abstractions.dll" />
                <File Id="FancyZones_Microsoft.Windows.SDK.NET.dll" Source="$(var.BinX64Dir)modules\$(var.FancyZonesProjectName)\Microsoft.Windows.SDK.NET.dll" />
                <File Id="FancyZones_WinRT.Runtime.dll" Source="$(var.BinX64Dir)modules\$(var.FancyZonesProjectName)\WinRT.Runtime.dll" />
            </Component>
        </DirectoryRef>

        <DirectoryRef Id="ToolsFolder">
            <Component Id="BugReportTool_exe" Guid="0F8E3E9F-2E86-4660-A3BF-AE4DD431B93C" Win64="yes">
                <File Source="$(var.BinX64Dir)BugReportTool\PowerToys.BugReportTool.exe" Id="BugReportTool.exe" KeyPath="yes" Checksum="yes" />
            </Component>
            <Component Id="WebcamReportTool_exe" Guid="B6005DAC-8C26-4865-91B3-99F098422C13" Win64="yes">
                <File Source="$(var.BinX64Dir)WebcamReportTool\PowerToys.WebcamReportTool.exe" Id="WebcamReportTool.exe" Checksum="yes" />
            </Component>
        </DirectoryRef>

        <DirectoryRef Id="ModulesInstallFolder" FileSource="$(var.BinX64Dir)modules\">
            <Component Id="Module_PowerPreview_Registry" Guid="CD90ADC0-7CD5-4A62-B0AF-23545C1E6DD3" Win64="yes">
                <!-- Update Key to use IE11 for prevhost.exe -->
                <RegistryKey Root="HKLM" Key="Software\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BROWSER_EMULATION">
                    <RegistryValue Type="integer" Name="prevhost.exe" Value="11000" />
                </RegistryKey>
                <!-- Update Key to use IE11 for dllhost.exe -->
                <RegistryKey Root="HKLM" Key="Software\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BROWSER_EMULATION">
                    <RegistryValue Type="integer" Name="dllhost.exe" Value="11000" />
                </RegistryKey>
            </Component>
        </DirectoryRef>

        <!-- Image Resizer -->
        <DirectoryRef Id="ImageResizerInstallFolder" FileSource="$(var.BinX64Dir)modules\$(var.ImageResizerProjectName)">
            <Component Id="Module_ImageResizer" Guid="96E63289-759C-4A73-A56B-EE7429932F72" Win64="yes">
                <File Source="$(var.BinX64Dir)modules\$(var.ImageResizerProjectName)\PowerToys.ImageResizer.exe" />
                <File Source="$(var.BinX64Dir)modules\$(var.ImageResizerProjectName)\PowerToys.ImageResizerExt.dll" KeyPath="yes" />
                <File Source="$(var.BinX64Dir)modules\$(var.ImageResizerProjectName)\PowerToys.ImageResizer.dll" />
                <File Source="$(var.BinX64Dir)modules\$(var.ImageResizerProjectName)\PowerToys.ImageResizer.deps.json" />
                <File Source="$(var.BinX64Dir)modules\$(var.ImageResizerProjectName)\PowerToys.ImageResizer.runtimeconfig.json" />
                <File Id="ImageResizer_ManagedCommon" Source="$(var.BinX64Dir)modules\$(var.ImageResizerProjectName)\PowerToys.ManagedCommon.dll" />
                <File Id="ImageResizer_ManagedTelemetry" Source="$(var.BinX64Dir)modules\$(var.ImageResizerProjectName)\PowerToys.ManagedTelemetry.dll" />
                <File Id="ImageResizer_Common.UI" Source="$(var.BinX64Dir)modules\$(var.ImageResizerProjectName)\PowerToys.Common.UI.dll" />
                <File Id="Module_ImageResizer_ControlzEX" Source="$(var.BinX64Dir)modules\$(var.ImageResizerProjectName)\ControlzEx.dll" />
                <File Id="Module_ImageResizer_ModernWpf_Controls" Source="$(var.BinX64Dir)modules\$(var.ImageResizerProjectName)\ModernWpf.Controls.dll" />
                <File Id="Module_ImageResizer_ModernWpf" Source="$(var.BinX64Dir)modules\$(var.ImageResizerProjectName)\ModernWpf.dll" />
                <File Id="Module_ImageResizer_System_Text_Json" Source="$(var.BinX64Dir)modules\$(var.ImageResizerProjectName)\System.Text.Json.dll" />
                <File Id="Module_ImageResizer_Microsoft_Xaml_Behaviors" Source="$(var.BinX64Dir)modules\$(var.ImageResizerProjectName)\Microsoft.Xaml.Behaviors.dll" />
                <File Id="ImageResizer_interop" Source="$(var.BinX64Dir)modules\$(var.ImageResizerProjectName)\PowerToys.Interop.dll" />
                <File Id="ImageResizer_System.IO.Abstractions.dll" Source="$(var.BinX64Dir)modules\$(var.ImageResizerProjectName)\System.IO.Abstractions.dll" />
                <File Id="ImageResizer_WinRT.Runtime.dll" Source="$(var.BinX64Dir)modules\$(var.ImageResizerProjectName)\WinRT.Runtime.dll" />
                <File Id="ImageResizer_Microsoft.Windows.SDK.NET.dll" Source="$(var.BinX64Dir)modules\$(var.ImageResizerProjectName)\Microsoft.Windows.SDK.NET.dll" />
                <!-- VCRuntime -->
                <?foreach File in vcruntime140.dll;vcruntime140_1.dll;concrt140.dll;msvcp140.dll;msvcp140_1.dll;msvcp140_2.dll;msvcp140_codecvt_ids.dll;vccorlib140.dll?>
                <File Id="ImageResizer_$(var.File)" Source="$(var.RepoDir)installer\VCRuntime\$(var.File)" />
                <?endforeach?>
            </Component>
            <Component Id="Module_ImageResizer_Registry" Guid="8B593E2C-2D9B-4EBC-93F7-A2B69707DAC9" Win64="yes">
                <RegistryKey Root="HKLM" Key="Software\Classes\CLSID\{51B4D7E5-7568-4234-B4BB-47FB3C016A69}\InprocServer32">
                    <RegistryValue Value="[ImageResizerInstallFolder]PowerToys.ImageResizerExt.dll" Type="string" />
                    <RegistryValue Name="ThreadingModel" Value="Apartment" Type="string" />
                </RegistryKey>

                <!-- Registry Key for the drag and drop handler -->
                <!-- To use later on when we want to install per user.
                <RegistryValue Root="HKCU"
                               Key="Software\Classes\Directory\ShellEx\DragDropHandlers\ImageResizer"
                               Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                               Type="string" />
                               -->
                <RegistryValue Root="HKCR"
                               Key="Directory\ShellEx\DragDropHandlers\ImageResizer"
                               Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                               Type="string" />
              <!-- Registry Keys for the context menu handler for each of the following image formats: bmp, dib, gif, jfif, jpe, jpeg, jpg, jxr, png, rle, tif, tiff, wdp  -->
              <RegistryValue Root="HKCR"
                               Key="SystemFileAssociations\.bmp\ShellEx\ContextMenuHandlers\ImageResizer"
                               Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                               Type="string" />
                <RegistryValue Root="HKCR"
                               Key="SystemFileAssociations\.dib\ShellEx\ContextMenuHandlers\ImageResizer"
                               Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                               Type="string" />
                <RegistryValue Root="HKCR"
                               Key="SystemFileAssociations\.gif\ShellEx\ContextMenuHandlers\ImageResizer"
                               Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                               Type="string" />
                <RegistryValue Root="HKCR"
                               Key="SystemFileAssociations\.jfif\ShellEx\ContextMenuHandlers\ImageResizer"
                               Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                               Type="string" />
                <RegistryValue Root="HKCR"
                               Key="SystemFileAssociations\.jpe\ShellEx\ContextMenuHandlers\ImageResizer"
                               Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                               Type="string" />
                <RegistryValue Root="HKCR"
                               Key="SystemFileAssociations\.jpeg\ShellEx\ContextMenuHandlers\ImageResizer"
                               Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                               Type="string" />
                <RegistryValue Root="HKCR"
                               Key="SystemFileAssociations\.jpg\ShellEx\ContextMenuHandlers\ImageResizer"
                               Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                               Type="string" />
                <RegistryValue Root="HKCR"
                               Key="SystemFileAssociations\.jxr\ShellEx\ContextMenuHandlers\ImageResizer"
                               Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                               Type="string" />
                <RegistryValue Root="HKCR"
                               Key="SystemFileAssociations\.png\ShellEx\ContextMenuHandlers\ImageResizer"
                               Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                               Type="string" />
                <RegistryValue Root="HKCR"
                               Key="SystemFileAssociations\.rle\ShellEx\ContextMenuHandlers\ImageResizer"
                               Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                               Type="string" />
                <RegistryValue Root="HKCR"
                               Key="SystemFileAssociations\.tif\ShellEx\ContextMenuHandlers\ImageResizer"
                               Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                               Type="string" />
                <RegistryValue Root="HKCR"
                               Key="SystemFileAssociations\.tiff\ShellEx\ContextMenuHandlers\ImageResizer"
                               Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                               Type="string" />
                <RegistryValue Root="HKCR"
                               Key="SystemFileAssociations\.wdp\ShellEx\ContextMenuHandlers\ImageResizer"
                               Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                               Type="string" />
            </Component>
        </DirectoryRef>

        <!-- PowerRename -->
        <DirectoryRef Id="PowerRenameInstallFolder" FileSource="$(var.BinX64Dir)modules\$(var.PowerRenameProjectName)">
            <Component Id="Module_PowerRename" Guid="E4401D08-27FE-4F96-BA17-0C61FD79E684" Win64="yes">
                <File Source="$(var.BinX64Dir)modules\$(var.PowerRenameProjectName)\Microsoft.Toolkit.Win32.UI.XamlHost.dll" />
                <File Source="$(var.BinX64Dir)modules\$(var.PowerRenameProjectName)\Microsoft.UI.Xaml.dll" />
                <File Source="$(var.BinX64Dir)modules\$(var.PowerRenameProjectName)\msvcp140_app.dll" />
                <File Source="$(var.BinX64Dir)modules\$(var.PowerRenameProjectName)\PowerToys.PowerRenameUILib.dll" />
                <File Source="$(var.BinX64Dir)modules\$(var.PowerRenameProjectName)\PowerToys.PowerRename.exe" />
                <File Source="$(var.BinX64Dir)modules\$(var.PowerRenameProjectName)\resources.pri" />
                <File Source="$(var.BinX64Dir)modules\$(var.PowerRenameProjectName)\vcruntime140_1_app.dll" />
                <File Source="$(var.BinX64Dir)modules\$(var.PowerRenameProjectName)\vcruntime140_app.dll" />
                <File Source="$(var.BinX64Dir)modules\$(var.PowerRenameProjectName)\PowerToys.PowerRenameExt.dll" KeyPath="yes" />
                <!-- VCRuntime -->
                <?foreach File in vcruntime140.dll;vcruntime140_1.dll;concrt140.dll;msvcp140.dll;msvcp140_1.dll;msvcp140_2.dll;msvcp140_codecvt_ids.dll;vccorlib140.dll?>
                <File Id="PowerRename_$(var.File)" Source="$(var.RepoDir)installer\VCRuntime\$(var.File)" />
                <?endforeach?>
                <RegistryKey Root="HKLM" Key="Software\Classes\CLSID\{0440049F-D1DC-4E46-B27B-98393D79486B}">
                    <RegistryValue Type="string" Value="PowerRename Shell Extension" />
                    <RegistryValue Type="string" Name="ContextMenuOptIn" Value="" />
                    <RegistryValue Type="string" Key="InprocServer32" Value="[PowerRenameInstallFolder]PowerToys.PowerRenameExt.dll" />
                    <RegistryValue Type="string" Key="InprocServer32" Name="ThreadingModel" Value="Apartment" />
                </RegistryKey>
                <RegistryKey Root="HKLM" Key="Software\Classes\AllFileSystemObjects\ShellEx\ContextMenuHandlers\PowerRenameExt">
                    <RegistryValue Type="string" Value="{0440049F-D1DC-4E46-B27B-98393D79486B}"/>
                </RegistryKey>
            </Component>
        </DirectoryRef>

        <DirectoryRef Id="PowerRenameAssetsFolder" FileSource="$(var.BinX64Dir)modules\$(var.PowerRenameProjectName)">
            <Component Id="Module_PowerRename_Assets" Guid="5976BEDF-64F5-4836-8674-EE7577C77508" Win64="yes">
                <File Source="$(var.BinX64Dir)modules\$(var.PowerRenameProjectName)\Assets\file.png" />
                <File Source="$(var.BinX64Dir)modules\$(var.PowerRenameProjectName)\Assets\folder.png" />
            </Component>
        </DirectoryRef>
        <!-- MouseUtils -->
        <DirectoryRef Id="MouseUtilsInstallFolder" FileSource="$(var.BinX64Dir)modules\$(var.MouseUtilsProjectName)">
            <Component Id="Module_FindMyMouse" Guid="60D0E4AE-188F-4403-BF06-1465AACC1BC5" Win64="yes">
                <File Source="$(var.BinX64Dir)modules\$(var.MouseUtilsProjectName)\PowerToys.FindMyMouse.dll" KeyPath="yes" />
            </Component>
            <Component Id="Module_MouseHighlighter" Guid="3BAEA39F-A73D-48D2-9616-BBED5B8C86D3" Win64="yes">
                <File Source="$(var.BinX64Dir)modules\$(var.MouseUtilsProjectName)\PowerToys.MouseHighlighter.dll" KeyPath="yes" />
            </Component>
            <Component Id="Module_MousePointerCrosshairs" Guid="157F664C-E993-49AC-B9E1-EBF73080D072" Win64="yes">
                <File Source="$(var.BinX64Dir)modules\$(var.MouseUtilsProjectName)\PowerToys.MousePointerCrosshairs.dll" KeyPath="yes" />
            </Component>
        </DirectoryRef>

        <!-- Shortcut guide -->
        <DirectoryRef Id="ShortcutGuideModuleInterfaceInstallFolder" FileSource="$(var.ShortcutGuideModuleInterface)">
            <Component Id="Module_ShortcutGuideModuleInterface" Guid="CBD0AC09-91D3-428E-B2B3-05745ADF3473" Win64="yes">
                <File Source="$(var.ShortcutGuideModuleInterface)\PowerToys.ShortcutGuideModuleInterface.dll" KeyPath="yes" />
            </Component>
        </DirectoryRef>

        <DirectoryRef Id="VideoConferenceInstallFolder" FileSource="$(var.BinX64Dir)modules\$(var.VideoConferenceProjectName)\">
            <Component Id="Module_VideoConference" Guid="5996527a-40fc-432e-b3ac-abc0b4bd3887" Win64="yes">
                <Condition>WINDOWSBUILDNUMBER >= 18362</Condition>
                <File Source="$(var.BinX64Dir)modules\$(var.VideoConferenceProjectName)\PowerToys.VideoConferenceProxyFilter_x64.dll" KeyPath="yes" />
                <File Source="$(var.BinX32Dir)modules\$(var.VideoConferenceProjectName)\PowerToys.VideoConferenceProxyFilter_x86.dll" />
                <File Source="$(var.BinX64Dir)modules\$(var.VideoConferenceProjectName)\PowerToys.VideoConferenceModule.dll" />
            </Component>
        </DirectoryRef>
        <DirectoryRef Id="VideoConferenceIconsFolder" FileSource="$(var.BinX64Dir)modules\$(var.VideoConferenceProjectName)\Icons">
            <Component Id="Module_VideoConferenceIcons" Guid="5996527a-40fc-432e-b34c-abc0b4bd3887" Win64="yes">
                <Condition>WINDOWSBUILDNUMBER >= 18362</Condition>
                <File Source="$(var.BinX64Dir)modules\$(var.VideoConferenceProjectName)\Icons\Off-NotInUse Dark.png" />
                <File Source="$(var.BinX64Dir)modules\$(var.VideoConferenceProjectName)\Icons\Off-NotInUse Light.png" />
                <File Source="$(var.BinX64Dir)modules\$(var.VideoConferenceProjectName)\Icons\Off-Off Dark.png" />
                <File Source="$(var.BinX64Dir)modules\$(var.VideoConferenceProjectName)\Icons\Off-Off Light.png" />
                <File Source="$(var.BinX64Dir)modules\$(var.VideoConferenceProjectName)\Icons\Off-On Dark.png" />
                <File Source="$(var.BinX64Dir)modules\$(var.VideoConferenceProjectName)\Icons\Off-On Light.png" />
                <File Source="$(var.BinX64Dir)modules\$(var.VideoConferenceProjectName)\Icons\On-NotInUse Dark.png" />
                <File Source="$(var.BinX64Dir)modules\$(var.VideoConferenceProjectName)\Icons\On-NotInUse Light.png" />
                <File Source="$(var.BinX64Dir)modules\$(var.VideoConferenceProjectName)\Icons\On-Off Light.png" />
                <File Source="$(var.BinX64Dir)modules\$(var.VideoConferenceProjectName)\Icons\On-Off Dark.png" />
                <File Source="$(var.BinX64Dir)modules\$(var.VideoConferenceProjectName)\Icons\On-On Dark.png" />
                <File Source="$(var.BinX64Dir)modules\$(var.VideoConferenceProjectName)\Icons\On-On Light.png" />
            </Component>
        </DirectoryRef>

        <DirectoryRef Id="ShortcutGuideExecutableInstallFolder" FileSource="$(var.ShortcutGuideExecutable)">
            <Component Id="Module_ShortcutGuideExecutable" Guid="DA6E5710-F1DF-44EB-A316-300FA39544E9" Win64="yes">
                <File Source="$(var.ShortcutGuideExecutable)\PowerToys.ShortcutGuide.exe" KeyPath="yes" />
            </Component>
        </DirectoryRef>

        <!-- KBM -->
        <DirectoryRef Id="KeyboardManagerInstallFolder" FileSource="$(var.BinX64Dir)modules\$(var.KeyboardManagerProjectName)\">
            <Component Id="Module_KeyboardManager" Guid="9279BD82-786F-4F0B-8E49-DB484EE34C9B" Win64="yes">
                <File Source="$(var.BinX64Dir)modules\$(var.KeyboardManagerProjectName)\PowerToys.KeyboardManager.dll" />
            </Component>
        </DirectoryRef>

        <!-- KBM Editor -->
        <DirectoryRef Id="KeyboardManagerEditorInstallFolder" FileSource="$(var.BinX64Dir)modules\$(var.KeyboardManagerProjectName)\KeyboardManagerEditor">
            <Component Id="Module_KeyboardManager_Editor" Guid="1240F1B8-17FE-4D68-B9AF-91882B0B1933" Win64="yes">
                <File Source="$(var.BinX64Dir)modules\$(var.KeyboardManagerProjectName)\KeyboardManagerEditor\PowerToys.KeyboardManagerEditor.exe" />
            </Component>
        </DirectoryRef>

        <!-- KBM Engine -->
        <DirectoryRef Id="KeyboardManagerEngineInstallFolder" FileSource="$(var.BinX64Dir)modules\$(var.KeyboardManagerProjectName)\KeyboardManagerEngine">
            <Component Id="Module_KeyboardManager_Engine" Guid="14DBAA38-B98D-431F-9439-8EDE1C0670DB" Win64="yes">
                <File Source="$(var.BinX64Dir)modules\$(var.KeyboardManagerProjectName)\KeyboardManagerEngine\PowerToys.KeyboardManagerEngine.exe" />
            </Component>
        </DirectoryRef>

        <!-- Color Picker -->
        <DirectoryRef Id="ColorPickerInstallFolder" FileSource="$(var.BinX64Dir)modules\$(var.ColorPickerProjectName)">
            <Component Id="Module_ColorPicker" Guid="8A52A69E-37B2-4BEA-9D73-77763066052F" Win64="yes">
                <?foreach File in PowerToys.ColorPicker.dll;System.IO.Abstractions.dll;PowerToys.ColorPickerUI.exe;PowerToys.ColorPickerUI.dll;PowerToys.ColorPickerUI.deps.json;PowerToys.ColorPickerUI.runtimeconfig.json;PowerToys.Settings.UI.Lib.dll;PowerToys.Interop.dll;System.Text.Json.dll;PowerToys.ManagedTelemetry.dll;PowerToys.ManagedCommon.dll;ControlzEx.dll;Microsoft.Xaml.Behaviors.dll;ModernWpf.Controls.dll;ModernWpf.dll;System.ComponentModel.Composition.dll;PowerToys.Common.UI.dll;WinRT.Runtime.dll;Microsoft.Windows.SDK.NET.dll?>
                <File Id="ColorPickerFile_$(var.File)" Source="$(var.BinX64Dir)modules\$(var.ColorPickerProjectName)\$(var.File)" />
                <?endforeach?>
            </Component>
        </DirectoryRef>

        <!-- Color Picker Resources -->
        <DirectoryRef Id="ColorPickerResourcesFolder" FileSource="$(var.BinX64Dir)modules\$(var.ColorPickerProjectName)\Resources">
            <Component Id="Module_ColorPicker_Resources" Guid="7544BD0F-1DB6-4C53-89D3-ADAD472FDCC1">
                <?foreach File in colorPicker.cur;icon.ico?>
                <File Id="ColorPickerFile_$(var.File)" Source="$(var.BinX64Dir)modules\$(var.ColorPickerProjectName)\Resources\$(var.File)" />
                <?endforeach?>
            </Component>
        </DirectoryRef>

        <!-- Awake -->
        <DirectoryRef Id="AwakeInstallFolder" FileSource="$(var.BinX64Dir)modules\$(var.AwakeProjectName)">
            <Component Id="Module_Awake" Guid="F26F5780-5B38-43B2-BC21-8406ED6E2071" Win64="yes">
                <?foreach File in PowerToys.AwakeModuleInterface.dll;PowerToys.ManagedCommon.dll;PowerToys.ManagedTelemetry.dll;PowerToys.Settings.UI.Lib.dll;Microsoft.Win32.SystemEvents.dll;NLog.config;NLog.dll;PowerToys.Awake.deps.json;PowerToys.Awake.dll;PowerToys.Awake.exe;PowerToys.Awake.runtimeconfig.json;PowerToys.Interop.dll;System.CommandLine.dll;System.Configuration.ConfigurationManager.dll;System.Drawing.Common.dll;System.IO.Abstractions.dll;System.Reactive.dll;System.Runtime.Caching.dll;System.Security.AccessControl.dll;System.Security.Cryptography.ProtectedData.dll;System.Security.Permissions.dll;System.Security.Principal.Windows.dll;System.Text.Json.dll;System.Windows.Extensions.dll?>
                <File Id="AwakeFile_$(var.File)" Source="$(var.BinX64Dir)modules\$(var.AwakeProjectName)\$(var.File)" />
                <?endforeach?>
            </Component>
        </DirectoryRef>

        <!-- Awake images -->
        <DirectoryRef Id="AwakeImagesFolder" FileSource="$(var.BinX64Dir)modules\$(var.AwakeProjectName)\Images">
            <Component Id="Module_Awake_Images" Guid="7ED8D364-9C23-4FFF-9FEA-FBC0760D99F7">
                <File Id="Awake_Awake.ico" Source="$(var.BinX64Dir)modules\$(var.AwakeProjectName)\Images\Awake.ico" />
            </Component>
        </DirectoryRef>

        <DirectoryRef Id="AwakeInstallFolderNetStandard20" FileSource="$(var.BinX64Dir)modules\$(var.AwakeProjectName)\runtimes\win\lib\netstandard2.0">
            <Component Id="Module_Awake_runtime_netstandard20" Guid="414A31AB-91A8-4F17-9B4B-DB7B93A2BB23">
                <File Id="AwakeFile_runtime_System.Runtime.Caching.dll" Source="$(var.BinX64Dir)modules\$(var.AwakeProjectName)\runtimes\win\lib\netstandard2.0\System.Runtime.Caching.dll" />
                <File Id="AwakeFile_runtime_System.Security.AccessControl.dll" Source="$(var.BinX64Dir)modules\$(var.AwakeProjectName)\runtimes\win\lib\netstandard2.0\System.Security.AccessControl.dll" />
                <File Id="AwakeFile_runtime_System.Security.Cryptography.ProtectedData.dll" Source="$(var.BinX64Dir)modules\$(var.AwakeProjectName)\runtimes\win\lib\netstandard2.0\System.Security.Cryptography.ProtectedData.dll" />
            </Component>
        </DirectoryRef>

        <DirectoryRef Id="AwakeInstallFolderNetcoreApp30" FileSource="$(var.BinX64Dir)modules\$(var.AwakeProjectName)\runtimes\win\lib\netcoreapp3.0">
            <Component Id="Module_Awake_runtime_netcoreapp30" Guid="1EBB21FE-083A-4AE6-9208-7DC72A421860">
                <File Id="AwakeFile_runtime_Microsoft.Win32.SystemEvents.dll" Source="$(var.BinX64Dir)modules\$(var.AwakeProjectName)\runtimes\win\lib\netcoreapp3.0\Microsoft.Win32.SystemEvents.dll" />
                <File Id="AwakeFile_runtime_System.Drawing.Common.dll" Source="$(var.BinX64Dir)modules\$(var.AwakeProjectName)\runtimes\win\lib\netcoreapp3.0\System.Drawing.Common.dll" />
                <File Id="AwakeFile_runtime_System.Windows.Extensions.dll" Source="$(var.BinX64Dir)modules\$(var.AwakeProjectName)\runtimes\win\lib\netcoreapp3.0\System.Windows.Extensions.dll" />
            </Component>
        </DirectoryRef>

        <DirectoryRef Id="AwakeInstallFolderNetcoreApp21" FileSource="$(var.BinX64Dir)modules\$(var.AwakeProjectName)\runtimes\win\lib\netcoreapp2.1">
            <Component Id="Module_Awake_runtime_netcoreapp21" Guid="52ED2831-6F3F-47D3-AA1A-88C697BE9D0F">
                <File Id="AwakeFile_runtime_System.Security.Principal.Windows.dll" Source="$(var.BinX64Dir)modules\$(var.AwakeProjectName)\runtimes\win\lib\netcoreapp2.1\System.Security.Principal.Windows.dll" />
            </Component>
        </DirectoryRef>

        <DirectoryRef Id="FileExplorerPreviewInstallFolder" FileSource="$(var.RepoDir)\modules\FileExplorerPreview\">
            <Component Id="Module_PowerPreview" Guid="FF1700D5-1B07-4E07-9A62-4D206645EEA9" Win64="yes">
                <!-- Component to include PowerPreview Module Source dll's -->
                <!-- File to include PowerPreview Module native dll -->
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.powerpreview.dll" KeyPath="yes" />
                <!-- File to include common library used by preview handlers -->
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.PreviewHandlerCommon.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.PreviewHandlerCommon.deps.json" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.ManagedCommon.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.ManagedTelemetry.dll" />
                <!-- File to include dll for Svg Preview Handler -->
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.SvgPreviewHandler.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.SvgPreviewHandler.comhost.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.SvgPreviewHandler.runtimeconfig.json" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.SvgPreviewHandler.deps.json" />
                <!-- File to include dll for Svg Thumbnail Provider -->
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.SvgThumbnailProvider.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.SvgThumbnailProvider.comhost.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.SvgThumbnailProvider.runtimeconfig.json" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.SvgThumbnailProvider.deps.json" />
                <!-- Files to include dll's for Markdown Preview Handler and it's dependencies -->
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.MarkdownPreviewHandler.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.MarkdownPreviewHandler.comhost.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.MarkdownPreviewHandler.runtimeconfig.json" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.MarkdownPreviewHandler.deps.json" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\Markdig.Signed.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\HtmlAgilityPack.dll" />
                <File Id="FileExplorerPreview_System.IO.Abstractions.dll" Source="$(var.BinX64Dir)modules\FileExplorerPreview\System.IO.Abstractions.dll" />
                <!-- Files to include dll's for Monaco Preview Handler and it's dependencies -->
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\languages.json" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.Common.UI.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.MonacoPreviewHandler.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.MonacoPreviewHandler.comhost.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.MonacoPreviewHandler.runtimeconfig.json" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.MonacoPreviewHandler.deps.json" />
                <File Id="FileExplorerPreview_ControlzEx.dll" Source="$(var.BinX64Dir)modules\FileExplorerPreview\ControlzEx.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\Microsoft.Web.WebView2.Core.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\Microsoft.Web.WebView2.WinForms.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\Microsoft.Web.WebView2.Wpf.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\System.Runtime.WindowsRuntime.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\index.html" />
                <!-- File to include dll for Pdf Preview Handler -->
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.PdfPreviewHandler.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.PdfPreviewHandler.comhost.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.PdfPreviewHandler.runtimeconfig.json" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.PdfPreviewHandler.deps.json" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\Microsoft.Windows.SDK.NET.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\WinRT.Runtime.dll" />
                <!-- File to include dll for Pdf Thumbnail Provider -->
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.PdfThumbnailProvider.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.PdfThumbnailProvider.comhost.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.PdfThumbnailProvider.runtimeconfig.json" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.PdfThumbnailProvider.deps.json" />
                <!-- File to include dll for G-code Preview Handler -->
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.GcodePreviewHandler.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.GcodePreviewHandler.comhost.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.GcodePreviewHandler.runtimeconfig.json" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.GcodePreviewHandler.deps.json" />
                <!-- File to include dll for G-code Thumbnail Provider -->
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.GcodeThumbnailProvider.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.GcodeThumbnailProvider.comhost.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.GcodeThumbnailProvider.runtimeconfig.json" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.GcodeThumbnailProvider.deps.json" />
                <!-- File to include dll for Stl Thumbnail Provider -->
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.StlThumbnailProvider.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.StlThumbnailProvider.comhost.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.StlThumbnailProvider.runtimeconfig.json" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PowerToys.StlThumbnailProvider.deps.json" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\HelixToolkit.dll" />
                <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\HelixToolkit.Core.Wpf.dll" />
            </Component>
        </DirectoryRef>
        <DirectoryRef Id="MonacoPreviewHandlerRuntimesWinX64NativeFolder" FileSource="$(var.BinX64Dir)modules\FileExplorerPreview\runtimes\win-x64\native">
            <Component Id="MonacoPreviewHandlerRuntimesWinX64NativeLibs" Guid="A867098B-5F8B-491B-A7DC-51F0907B570F" Win64="yes">
                <File Id="MonacoPreviewHandler_WebView2Loader" Source="$(var.BinX64Dir)modules\FileExplorerPreview\runtimes\win-x64\native\WebView2Loader.dll" />
            </Component>
        </DirectoryRef>

        <!-- AlwaysOnTop -->
        <DirectoryRef Id="AlwaysOnTopInstallFolder" FileSource="$(var.BinX64Dir)modules\$(var.AlwaysOnTopProjectName)">
            <Component Id="Module_AlwaysOnTop" Guid="599D40E7-862A-4A4C-8013-D9CE0BEB3D6C" Win64="yes">
                <File Source="$(var.BinX64Dir)modules\$(var.AlwaysOnTopProjectName)\PowerToys.AlwaysOnTopModuleInterface.dll" KeyPath="yes" />
                <File Source="$(var.BinX64Dir)modules\$(var.AlwaysOnTopProjectName)\PowerToys.AlwaysOnTop.exe" />
            </Component>
        </DirectoryRef>

        <!-- SettingsV2 components -->
        <DirectoryRef Id="SettingsV2InstallFolder" FileSource="$(var.BinX64Dir)Settings\">
            <Component Id="SettingsV2" Guid="4B108DC0-4B2C-4AC4-AAA9-1B2DC8399F7C" Win64="yes">
                <!-- exe -->
                <File Source="$(var.BinX64Dir)Settings\PowerToys.Settings.exe"/>
                <File Source="$(var.BinX64Dir)Settings\PowerToys.Settings.UI.exe"/>
                <!-- dll -->
                <?foreach File in concrt140_app.dll;Microsoft.Bcl.AsyncInterfaces.dll;System.IO.Abstractions.dll;PowerToys.Settings.UI.Lib.dll;PowerToys.Settings.dll;Microsoft.Toolkit.dll;Microsoft.Toolkit.Uwp.dll;Microsoft.Toolkit.Uwp.UI.dll;Microsoft.Toolkit.Win32.UI.XamlHost.dll;Microsoft.Toolkit.Win32.UI.XamlHost.Managed.dll;Microsoft.Toolkit.Wpf.UI.Controls.dll;Microsoft.Toolkit.Wpf.UI.XamlHost.dll;Microsoft.UI.Xaml.dll;Microsoft.Xaml.Interactions.dll;Microsoft.Xaml.Interactivity.dll;msvcp140_1_app.dll;msvcp140_2_app.dll;msvcp140_app.dll;PowerToys.Interop.dll;System.Runtime.CompilerServices.Unsafe.dll;System.Text.Encodings.Web.dll;System.Text.Json.dll;vcamp140_app.dll;vccorlib140_app.dll;vcomp140_app.dll;vcruntime140_1_app.dll;vcruntime140_app.dll;PowerToys.ManagedTelemetry.dll;PowerToys.ManagedCommon.dll;ColorCode.Core.dll;ColorCode.UWP.dll;Microsoft.Graphics.Canvas.winmd;Microsoft.Toolkit.Uwp.UI.Controls.Core.dll;Microsoft.Toolkit.Uwp.UI.Controls.DataGrid.dll;Microsoft.Toolkit.Uwp.UI.Controls.Input.dll;Microsoft.Toolkit.Uwp.UI.Controls.Layout.dll;Microsoft.Toolkit.Uwp.UI.Controls.Markdown.dll;Microsoft.Toolkit.Uwp.UI.Controls.Media.dll;Microsoft.Toolkit.Uwp.UI.Controls.Primitives.dll?>
                <File Id="SettingsV2_$(var.File)" Source="$(var.BinX64Dir)Settings\$(var.File)" />
                <?endforeach?>
                <!-- json -->
                <File Source="$(var.BinX64Dir)Settings\PowerToys.Settings.deps.json"/>
                <File Source="$(var.BinX64Dir)Settings\PowerToys.Settings.runtimeconfig.json"/>
                <!-- png -->
                <File Id="SettingsV2_NoiseAsset_256x256_PNG.png" Source="$(var.BinX64Dir)Settings\NoiseAsset_256x256_PNG.png"/>
                <!-- pri -->
                <?foreach File in Microsoft.Toolkit.Uwp.pri;Microsoft.Toolkit.Uwp.UI.pri;Microsoft.Toolkit.Win32.UI.XamlHost.pri;Microsoft.UI.Xaml.pri;Microsoft.Xaml.Interactions.pri;Microsoft.Xaml.Interactivity.pri;resources.pri?>
                <File Id="SettingsV2_$(var.File)" Source="$(var.BinX64Dir)Settings\$(var.File)" />
                <?endforeach?>
                <!-- winmd -->
                <File Id="SettingsV2_Microsoft.Toolkit.Win32.UI.XamlHost.winmd" Source="$(var.BinX64Dir)Settings\Microsoft.Toolkit.Win32.UI.XamlHost.winmd"/>
                <File Id="SettingsV2_Microsoft.UI.Xaml.winmd" Source="$(var.BinX64Dir)Settings\Microsoft.UI.Xaml.winmd"/>
                <!-- xbf -->
                <File Id="SettingsV2_App.xbf" Source="$(var.BinX64Dir)Settings\App.xbf"/>
                <!-- xml -->
                <File Id="SettingsV2_PowerToys.Settings.UI.xr.xml" Source="$(var.BinX64Dir)Settings\PowerToys.Settings.UI.xr.xml"/>
                <File Id="SettingsV2_Microsoft.Toolkit.Win32.UI.XamlHost.xml" Source="$(var.BinX64Dir)Settings\Microsoft.Toolkit.Win32.UI.XamlHost.xml"/>
                <!-- VCRuntime -->
                <?foreach File in vcruntime140.dll;vcruntime140_1.dll;concrt140.dll;msvcp140.dll;msvcp140_1.dll;msvcp140_2.dll;msvcp140_codecvt_ids.dll;vccorlib140.dll?>
                <File Id="SettingsV2_$(var.File)" Source="$(var.RepoDir)installer\VCRuntime\$(var.File)" />
                <?endforeach?>
            </Component>
        </DirectoryRef>
        <DirectoryRef Id="SettingsV2AssetsInstallFolder" FileSource="$(var.BinX64Dir)Settings\Assets">
            <Component Id="SettingsV2Assets" Guid="705B863B-D813-49B9-BAA1-210DA913F765" Win64="yes">
                <?foreach File in Logo.scale-200.png;SplashScreen.png;StoreLogo.scale-100.png?>
                <File Source="$(var.BinX64Dir)Settings\Assets\$(var.File)" />
                <?endforeach?>
                <File Id="SettingsV2_StoreLogo" Source="$(var.BinX64Dir)Settings\Assets\StoreLogo.png" />
                <File Id="Square150x150Logo" Source="$(var.BinX64Dir)Settings\Assets\Square150x150Logo.scale-200.png" />
                <File Id="Square44x44Logo_targetsize_24_altform_unplated" Source="$(var.BinX64Dir)Settings\Assets\Square44x44Logo.targetsize-24_altform-unplated.png" />
                <File Id="Wide310x150Logo" Source="$(var.BinX64Dir)Settings\Assets\Wide310x150Logo.scale-200.png" />
                <File Id="Square44x44Logo" Source="$(var.BinX64Dir)Settings\Assets\Square44x44Logo.scale-200.png" />
            </Component>
        </DirectoryRef>
        <DirectoryRef Id="SettingsV2AssetsModulesInstallFolder" FileSource="$(var.BinX64Dir)Settings\Assets\Modules">
            <Component Id="SettingsV2AssetsModules" Guid="A0B961A9-77D0-4223-88A9-E3B41BD9C329" Win64="yes">
                <?foreach File in ColorPicker.png;FancyZones.png;AlwaysOnTop.png;Awake.png;ImageResizer.png;KBM.png;MouseUtils.png;PowerLauncher.png;PowerPreview.png;PowerRename.png;PT.png;ShortcutGuide.png;VideoConference.png?>
                <File Id="SettingsV2AssetsModules_$(var.File)" Source="$(var.BinX64Dir)Settings\Assets\Modules\$(var.File)" />
                <?endforeach?>
            </Component>
        </DirectoryRef>
        <DirectoryRef Id="SettingsV2OOBEAssetsModulesInstallFolder" FileSource="$(var.BinX64Dir)Settings\Assets\Modules\OOBE">
            <Component Id="SettingsV2OOBEAssetsModules" Guid="E2360A83-6694-4B33-B5F6-641A906359EE" Win64="yes">
                <?foreach File in ColorPicker.gif;AlwaysOnTop.png;Awake.png;FancyZones.gif;FileExplorer.png;ImageResizer.gif;KBM.gif;MouseUtils.gif;PowerRename.gif;Run.gif;OOBEShortcutGuide.png;VideoConferenceMute.png;OOBEPTHero.png?>
                <File Id="SettingsV2OOBEAssetsModules_$(var.File)"  Source="$(var.BinX64Dir)Settings\Assets\Modules\OOBE\$(var.File)" />
                <?endforeach?>
            </Component>
        </DirectoryRef>
        <DirectoryRef Id="SettingsV2OOBEAssetsFluentIconsInstallFolder" FileSource="$(var.BinX64Dir)Settings\Assets\FluentIcons">
            <Component Id="SettingsV2OOBEAssetsFluentIcons" Guid="6A380D5A-DA63-45B5-B68F-06D57CDD1B9C" Win64="yes">
                <?foreach File in ColorPicker.png;FancyZones.png;AlwaysOnTop.png;Awake.png;FileExplorerPreview.png;FindMyMouse.png;ImageResizer.png;KeyboardManager.png;MouseHighlighter.png;MouseCrosshairs.png;MouseUtils.png;PowerRename.png;PowerToys.png;PowerToysRun.png;Settings.png;ShortcutGuide.png;VideoConferenceMute.png ?>
                <File Id="SettingsV2OOBEAssetsFluentIcons_$(var.File)"  Source="$(var.BinX64Dir)Settings\Assets\FluentIcons\FluentIcons$(var.File)" />
                <?endforeach?>
            </Component>
        </DirectoryRef>
        <DirectoryRef Id="SettingsV2ControlsInstallFolder" FileSource="$(var.BinX64Dir)Settings\Controls\ShortcutControl">
            <Component Id="SettingsV2Controls" Guid="05C55C88-B59A-4450-A07C-EB7626E0781A" Win64="yes">
                <?foreach File in ShortcutControl.xbf?>
                <File Id="SettingsV2_Controls_$(var.File)" Source="$(var.BinX64Dir)Settings\Controls\ShortcutControl\$(var.File)" />
                <?endforeach?>
            </Component>
        </DirectoryRef>
        <DirectoryRef Id="SettingsV2PropertiesInstallFolder" FileSource="$(var.BinX64Dir)Settings\Properties">
            <Component Id="SettingsV2Properties" Guid="8F910A41-B27B-4289-8FAC-9AB34F070CF6" Win64="yes">
                <?foreach File in Default.rd.xml?>
                <File Id="SettingsV2_Properties_$(var.File)" Source="$(var.BinX64Dir)Settings\Properties\$(var.File)" />
                <?endforeach?>
            </Component>
        </DirectoryRef>
        <DirectoryRef Id="SettingsV2StylesInstallFolder" FileSource="$(var.BinX64Dir)Settings\Styles">
            <Component Id="SettingsV2Styles" Guid="44B5C0E0-76DA-4604-BB86-FCD27A00EB71" Win64="yes">
                <?foreach File in TextBlock.xbf;Button.xbf?>
                <File Id="SettingsV2_Styles_$(var.File)" Source="$(var.BinX64Dir)Settings\Styles\$(var.File)" />
                <?endforeach?>
            </Component>
        </DirectoryRef>
        <DirectoryRef Id="SettingsV2ViewsInstallFolder" FileSource="$(var.BinX64Dir)Settings\Views">
            <Component Id="SettingsV2Views" Guid="C140BFBA-6370-4F67-862C-5B42660385CD" Win64="yes">
                <?foreach File in FancyZonesPage.xbf;GeneralPage.xbf;ImageResizerPage.xbf;KeyboardManagerPage.xbf;PowerLauncherPage.xbf;PowerPreviewPage.xbf;PowerRenamePage.xbf;ShellPage.xbf;ShortcutGuidePage.xbf?>
                <File Id="SettingsV2_Views_$(var.File)" Source="$(var.BinX64Dir)Settings\Views\$(var.File)" />
                <?endforeach?>
            </Component>
        </DirectoryRef>
        <DirectoryRef Id="SettingsV2XamlAssetsInstallFolder" FileSource="$(var.BinX64Dir)Settings\Microsoft.UI.Xaml\Assets">
            <Component Id="SettingsV2XamlAssets" Guid="98A136DB-C1BD-42B1-9AB4-0E16F0ECE86A" Win64="yes">
                <?foreach File in NoiseAsset_256X256_PNG.png?>
                <File Id="SettingsV2_XamlAssets_$(var.File)" Source="$(var.BinX64Dir)Settings\Microsoft.UI.Xaml\Assets\$(var.File)" />
                <?endforeach?>
            </Component>
        </DirectoryRef>

        <DirectoryRef Id="DesktopFolder">
            <Component Id="DesktopShortcut" Guid="87321F2B-CC48-4326-881E-9C62CC260DC8">
                <Condition>INSTALLDESKTOPSHORTCUT</Condition>
                <!-- DesktopShortcutId is implicitly installed in HKCU, so WIX won't allow changing this reg value to HKLM. -->
                <RegistryValue Root="HKCU"
                                Key="Software\[Manufacturer]\[ProductName]"
                                Name="desktopshorcutinstalled"
                                Type="integer"
                                Value="1"
                                KeyPath="yes"/>
                <Shortcut Id="DesktopShortcutId"
                          Name="PowerToys (Preview)"
                          Description="PowerToys - Windows system utilities to maximize productivity"
                          Target="[!PowerToys.exe]"
                          WorkingDirectory="INSTALLFOLDER"
                          Icon="powertoys.exe"
                          Directory="DesktopFolder"/>
            </Component>
        </DirectoryRef>
    </Fragment>

    <Fragment>
        <ComponentGroup Id="CoreComponents" Directory="INSTALLFOLDER">
            <ComponentRef Id="powertoys_exe" />
            <ComponentRef Id="PowerToysStartMenuShortcut"/>
            <ComponentRef Id="BackgroundActivator_dll" />
            <ComponentRef Id="PowerToys_ActionRunner_exe" />
            <ComponentRef Id="PowerToys_Update_exe" />
            <ComponentRef Id="powertoys_toast_clsid" />
            <ComponentRef Id="License_rtf" />
            <ComponentRef Id="Notice_md" />
            <ComponentRef Id="powertoysinterop_dll" />
            <ComponentRef Id="vcredist_dlls" />
            <ComponentRef Id="ShortcutGuideSvgs" />
            <ComponentRef Id="Module_ShortcutGuideModuleInterface" />
            <ComponentRef Id="Module_ShortcutGuideExecutable" />
            <ComponentRef Id="Module_VideoConference" />
            <ComponentRef Id="Module_VideoConferenceIcons" />
            <ComponentRef Id="Module_FancyZones" />
            <ComponentRef Id="DesktopShortcut" />
            <ComponentRef Id="Module_PowerRename" />
            <ComponentRef Id="Module_PowerRename_Assets" />
            <ComponentRef Id="Module_ImageResizer" />
            <ComponentRef Id="Module_ImageResizer_Registry" />
            <ComponentRef Id="Module_PowerPreview" />
            <ComponentRef Id="MonacoPreviewHandlerRuntimesWinX64NativeLibs" />
            <ComponentRef Id="Module_PowerPreview_Registry" />
            <ComponentRef Id="Module_KeyboardManager" />
            <ComponentRef Id="Module_KeyboardManager_Editor" />
            <ComponentRef Id="Module_KeyboardManager_Engine" />
            <ComponentRef Id="Module_ColorPicker" />
            <ComponentRef Id="Module_ColorPicker_Resources"/>
            <ComponentRef Id="Module_Awake"/>
            <ComponentRef Id="Module_Awake_Images"/>
            <ComponentRef Id="Module_Awake_runtime_netstandard20"/>
            <ComponentRef Id="Module_Awake_runtime_netcoreapp30"/>
            <ComponentRef Id="Module_Awake_runtime_netcoreapp21"/>
            <ComponentRef Id="Module_FindMyMouse"/>
            <ComponentRef Id="Module_MouseHighlighter"/>
            <ComponentRef Id="Module_MousePointerCrosshairs" />
            <ComponentRef Id="Module_AlwaysOnTop"/>
            <ComponentRef Id="SettingsV2" />
            <ComponentRef Id="SettingsV2Assets" />
            <ComponentRef Id="SettingsV2AssetsModules" />
            <ComponentRef Id="SettingsV2OOBEAssetsFluentIcons" />
            <ComponentRef Id="SettingsV2OOBEAssetsModules" />
            <ComponentRef Id="SettingsV2Controls" />
            <ComponentRef Id="SettingsV2Properties" />
            <ComponentRef Id="SettingsV2Styles" />
            <ComponentRef Id="SettingsV2Views" />
            <ComponentRef Id="SettingsV2XamlAssets" />
        </ComponentGroup>
        <ComponentGroup Id="ToolComponents" Directory="ToolsFolder">
            <ComponentRef Id="BugReportTool_exe" />
            <ComponentRef Id="WebcamReportTool_exe" />
        </ComponentGroup>
    </Fragment>

    <!-- Languages for localization on build farm -->
    <?define LocLanguageList = cs-CZ;de-DE;es-ES;fr-FR;hu-HU;it-IT;ja-JP;ko-KR;nl-NL;pl-PL;pt-BR;pt-PT;qps-ploc;qps-ploca;qps-plocm;ru-RU;sv-SE;tr-TR;zh-CN;zh-TW?>

    <Fragment>
        <!-- Resource directories should be added only if the installer is built on the build farm -->
        <?ifdef env.IsPipeline?>
        <?foreach ParentDirectory in LauncherInstallFolder;FancyZonesInstallFolder;ImageResizerInstallFolder;ColorPickerInstallFolder;FileExplorerPreviewInstallFolder;CalculatorPluginFolder;FolderPluginFolder;ProgramPluginFolder;ShellPluginFolder;IndexerPluginFolder;UnitConverterPluginFolder;UriPluginFolder;WindowWalkerPluginFolder;RegistryPluginFolder;VSCodeWorkspacesPluginFolder;ServicePluginFolder;SystemPluginFolder;WindowsSettingsPluginFolder;WindowsTerminalPluginFolder;WebSearchPluginFolder?>
        <DirectoryRef Id="$(var.ParentDirectory)">
            <!-- Resource file directories -->
            <?foreach Language in $(var.LocLanguageList)?>
            <!--NB: Ids can't contain hyphens-->
            <?if $(var.Language) = cs-CZ?>
            <?define IdSafeLanguage = cs_CZ?>
            <?elseif $(var.Language) = de-DE?>
            <?define IdSafeLanguage = de_DE?>
            <?elseif $(var.Language) = es-ES?>
            <?define IdSafeLanguage = es_ES?>
            <?elseif $(var.Language) = fr-FR?>
            <?define IdSafeLanguage = fr_FR?>
            <?elseif $(var.Language) = hu-HU?>
            <?define IdSafeLanguage = hu_HU?>
            <?elseif $(var.Language) = it-IT?>
            <?define IdSafeLanguage = it_IT?>
            <?elseif $(var.Language) = ja-JP?>
            <?define IdSafeLanguage = ja_JP?>
            <?elseif $(var.Language) = ko-KR?>
            <?define IdSafeLanguage = ko_KR?>
            <?elseif $(var.Language) = nl-NL?>
            <?define IdSafeLanguage = nl_NL?>
            <?elseif $(var.Language) = pl-PL?>
            <?define IdSafeLanguage = pl_PL?>
            <?elseif $(var.Language) = pt-BR?>
            <?define IdSafeLanguage = pt_BR?>
            <?elseif $(var.Language) = pt-PT?>
            <?define IdSafeLanguage = pt_PT?>
            <?elseif $(var.Language) = qps-ploc?>
            <?define IdSafeLanguage = qps_ploc?>
            <?elseif $(var.Language) = qps-ploca?>
            <?define IdSafeLanguage = qps_ploca?>
            <?elseif $(var.Language) = qps-plocm?>
            <?define IdSafeLanguage = qps_plocm?>
            <?elseif $(var.Language) = ru-RU?>
            <?define IdSafeLanguage = ru_RU?>
            <?elseif $(var.Language) = sv-SE?>
            <?define IdSafeLanguage = sv_SE?>
            <?elseif $(var.Language) = tr-TR?>
            <?define IdSafeLanguage = tr_TR?>
            <?elseif $(var.Language) = zh-CN?>
            <?define IdSafeLanguage = zh_CN?>
            <?elseif $(var.Language) = zh-TW?>
            <?define IdSafeLanguage = zh_TW?>
            <?else?>
            <?define IdSafeLanguage = $(var.Language)?>
            <?endif?>
            <Directory Id="Resource$(var.IdSafeLanguage)$(var.ParentDirectory)" Name="$(var.Language)" />
            <?undef IdSafeLanguage?>
            <?endforeach?>
        </DirectoryRef>
        <?endforeach?>
        <?endif?>
        <ComponentGroup Id="ResourcesComponents">
            <!-- Resource components should be added only if the installer is built on the build farm -->
            <?ifdef env.IsPipeline?>
            <!-- Components for adding resource files -->
            <?foreach Language in $(var.LocLanguageList)?>
            <!--NB: Ids can't contain hyphens-->
            <?if $(var.Language) = cs-CZ?>
            <!-- CompGUIDPrefix is language-dependent guid prefix missing the last 2 digits. -->
            <?define CompGUIDPrefix = 3E93405A-B91B-4E04-BAEC-26BEEE60F9?>
            <?define IdSafeLanguage = cs_CZ?>
            <?elseif $(var.Language) = de-DE?>
            <?define CompGUIDPrefix = AF28C057-7ED9-474C-8E7E-D583BE8ECF?>
            <?define IdSafeLanguage = de_DE?>
            <?elseif $(var.Language) = es-ES?>
            <?define CompGUIDPrefix = DD1FEEBD-55F0-44BA-A0FF-62C5C1C952?>
            <?define IdSafeLanguage = es_ES?>
            <?elseif $(var.Language) = fr-FR?>
            <?define CompGUIDPrefix = F9F86D61-C747-43FC-8509-F3D1F198E1?>
            <?define IdSafeLanguage = fr_FR?>
            <?elseif $(var.Language) = hu-HU?>
            <?define CompGUIDPrefix = 9A919A40-E457-47F5-97C8-E886F06DDE?>
            <?define IdSafeLanguage = hu_HU?>
            <?elseif $(var.Language) = it-IT?>
            <?define CompGUIDPrefix = 48FBF6D9-32DB-46FF-A64C-225269E738?>
            <?define IdSafeLanguage = it_IT?>
            <?elseif $(var.Language) = ja-JP?>
            <?define CompGUIDPrefix = FB8E04AB-C8E8-43C0-8883-19F73E4EBA?>
            <?define IdSafeLanguage = ja_JP?>
            <?elseif $(var.Language) = ko-KR?>
            <?define CompGUIDPrefix = 86C8F07C-80CA-420A-B6E7-86933D640C?>
            <?define IdSafeLanguage = ko_KR?>
            <?elseif $(var.Language) = nl-NL?>
            <?define CompGUIDPrefix = C68F115F-28DD-4B45-9512-405C432458?>
            <?define IdSafeLanguage = nl_NL?>
            <?elseif $(var.Language) = pl-PL?>
            <?define CompGUIDPrefix = 97494A31-5F57-4EC1-A6A9-994DF0813B?>
            <?define IdSafeLanguage = pl_PL?>
            <?elseif $(var.Language) = pt-BR?>
            <?define CompGUIDPrefix = F4985235-2AB9-446B-BF8E-B14929A160?>
            <?define IdSafeLanguage = pt_BR?>
            <?elseif $(var.Language) = pt-PT?>
            <?define CompGUIDPrefix = 58155841-D53A-4330-89D3-5C0338B928?>
            <?define IdSafeLanguage = pt_PT?>
            <?elseif $(var.Language) = qps-ploc?>
            <?define CompGUIDPrefix = 75710CB2-DBDA-420B-9676-34D5F9D4A2?>
            <?define IdSafeLanguage = qps_ploc?>
            <?elseif $(var.Language) = qps-ploca?>
            <?define CompGUIDPrefix = 55AF2A35-F959-49AB-B9EF-DFC9964A4F?>
            <?define IdSafeLanguage = qps_ploca?>
            <?elseif $(var.Language) = qps-plocm?>
            <?define CompGUIDPrefix = D8CE2F7B-B0A1-4687-BFB7-1792B2FCCD?>
            <?define IdSafeLanguage = qps_plocm?>
            <?elseif $(var.Language) = ru-RU?>
            <?define CompGUIDPrefix = 157BAF33-8D3F-46B7-9CF9-2C18E601CC?>
            <?define IdSafeLanguage = ru_RU?>
            <?elseif $(var.Language) = sv-SE?>
            <?define CompGUIDPrefix = 85B4199F-5F89-42C3-B7C2-DBCD3E5267?>
            <?define IdSafeLanguage = sv_SE?>
            <?elseif $(var.Language) = tr-TR?>
            <?define CompGUIDPrefix = EA375345-F52A-499B-A45E-108CE67EAF?>
            <?define IdSafeLanguage = tr_TR?>
            <?elseif $(var.Language) = zh-CN?>
            <?define CompGUIDPrefix = F8EE7CE9-58EA-4850-B76F-C22362DC0E?>
            <?define IdSafeLanguage = zh_CN?>
            <?elseif $(var.Language) = zh-TW?>
            <?define CompGUIDPrefix = F07F3210-79E2-4C38-AEF7-D8EBE06621?>
            <?define IdSafeLanguage = zh_TW?>
            <?else?>
            <?define IdSafeLanguage = $(var.Language)?>
            <?define CompGUIDPrefix = 94D9A417-56FC-435D-8167-A45F5D7A75?>
            <?endif?>
            <Component
                Id="Launcher_$(var.IdSafeLanguage)_Component"
                Directory="Resource$(var.IdSafeLanguage)LauncherInstallFolder"
                Guid="$(var.CompGUIDPrefix)00">
                <File Id="Launcher_$(var.IdSafeLanguage)_File" Source="$(var.BinX64Dir)modules\launcher\$(var.Language)\PowerToys.PowerLauncher.resources.dll" />
            </Component>
            <Component
                Id="FancyZonesEditor_$(var.IdSafeLanguage)_Component"
                Directory="Resource$(var.IdSafeLanguage)FancyZonesInstallFolder"
                Guid="$(var.CompGUIDPrefix)01">
                <File Id="FancyZonesEditor_$(var.IdSafeLanguage)_File" Source="$(var.BinX64Dir)modules\$(var.FancyZonesProjectName)\$(var.Language)\PowerToys.FancyZonesEditor.resources.dll" />
            </Component>
            <Component
                Id="ImageResizer_$(var.IdSafeLanguage)_Component"
                Directory="Resource$(var.IdSafeLanguage)ImageResizerInstallFolder"
                Guid="$(var.CompGUIDPrefix)02">
                <File Id="ImageResizer_$(var.IdSafeLanguage)_File" Source="$(var.BinX64Dir)modules\$(var.ImageResizerProjectName)\$(var.Language)\PowerToys.ImageResizer.resources.dll" />
            </Component>
            <Component
                Id="ColorPicker_$(var.IdSafeLanguage)_Component"
                Directory="Resource$(var.IdSafeLanguage)ColorPickerInstallFolder"
                Guid="$(var.CompGUIDPrefix)03">
                <File Id="ColorPicker_$(var.IdSafeLanguage)_File" Source="$(var.BinX64Dir)modules\$(var.ColorPickerProjectName)\$(var.Language)\PowerToys.ColorPickerUI.resources.dll" />
            </Component>
            <Component
                Id="MarkdownPreviewHandler_$(var.IdSafeLanguage)_Component"
                Directory="Resource$(var.IdSafeLanguage)FileExplorerPreviewInstallFolder"
                Guid="$(var.CompGUIDPrefix)04">
                <File Id="MarkdownPreviewHandler_$(var.IdSafeLanguage)_File" Source="$(var.BinX64Dir)modules\FileExplorerPreview\$(var.Language)\PowerToys.MarkdownPreviewHandler.resources.dll" />
            </Component>
            <Component
                Id="SVGPreviewHandler_$(var.IdSafeLanguage)_Component"
                Directory="Resource$(var.IdSafeLanguage)FileExplorerPreviewInstallFolder"
                Guid="$(var.CompGUIDPrefix)05">
                <File Id="SVGPreviewHandler_$(var.IdSafeLanguage)_File" Source="$(var.BinX64Dir)modules\FileExplorerPreview\$(var.Language)\PowerToys.SvgPreviewHandler.resources.dll" />
            </Component>
            <Component
                Id="PDFPreviewHandler_$(var.IdSafeLanguage)_Component"
                Directory="Resource$(var.IdSafeLanguage)FileExplorerPreviewInstallFolder"
                Guid="$(var.CompGUIDPrefix)06">
                <File Id="PDFPreviewHandler_$(var.IdSafeLanguage)_File" Source="$(var.BinX64Dir)modules\FileExplorerPreview\$(var.Language)\PowerToys.PdfPreviewHandler.resources.dll" />
            </Component>
            <Component
                Id="GcodePreviewHandler_$(var.IdSafeLanguage)_Component"
                Directory="Resource$(var.IdSafeLanguage)FileExplorerPreviewInstallFolder"
                Guid="$(var.CompGUIDPrefix)07">
                <File Id="GcodePreviewHandler_$(var.IdSafeLanguage)_File" Source="$(var.BinX64Dir)modules\FileExplorerPreview\$(var.Language)\PowerToys.GcodePreviewHandler.resources.dll" />
            </Component>
            <!-- PowerToys Run aka Launcher plugin resources -->
            <Component
                Id="Launcher_Calculator_$(var.IdSafeLanguage)_Component"
                Directory="Resource$(var.IdSafeLanguage)CalculatorPluginFolder"
                Guid="$(var.CompGUIDPrefix)08">
                <File Id="Launcher_Calculator_$(var.IdSafeLanguage)_File" Source="$(var.BinX64Dir)modules\launcher\Plugins\Calculator\$(var.Language)\Microsoft.PowerToys.Run.Plugin.Calculator.resources.dll" />
            </Component>
            <Component
                Id="Launcher_Folder_$(var.IdSafeLanguage)_Component"
                Directory="Resource$(var.IdSafeLanguage)FolderPluginFolder"
                Guid="$(var.CompGUIDPrefix)09">
                <File Id="Launcher_Folder_$(var.IdSafeLanguage)_File" Source="$(var.BinX64Dir)modules\launcher\Plugins\Folder\$(var.Language)\Microsoft.Plugin.Folder.resources.dll" />
            </Component>
            <Component
                Id="Launcher_Program_$(var.IdSafeLanguage)_Component"
                Guid="$(var.CompGUIDPrefix)0A"
                Directory="Resource$(var.IdSafeLanguage)ProgramPluginFolder">
                <File Id="Launcher_Program_$(var.IdSafeLanguage)_File" Source="$(var.BinX64Dir)modules\launcher\Plugins\Program\$(var.Language)\Microsoft.Plugin.Program.resources.dll" />
            </Component>
            <Component
                Id="Launcher_Shell_$(var.IdSafeLanguage)_Component"
                Guid="$(var.CompGUIDPrefix)0B"
                Directory="Resource$(var.IdSafeLanguage)ShellPluginFolder">
                <File Id="Launcher_Shell_$(var.IdSafeLanguage)_File" Source="$(var.BinX64Dir)modules\launcher\Plugins\Shell\$(var.Language)\Microsoft.Plugin.Shell.resources.dll" />
            </Component>
            <Component
                Id="Launcher_Indexer_$(var.IdSafeLanguage)_Component"
                Guid="$(var.CompGUIDPrefix)0C"
                Directory="Resource$(var.IdSafeLanguage)IndexerPluginFolder">
                <File Id="Launcher_Indexer_$(var.IdSafeLanguage)_File" Source="$(var.BinX64Dir)modules\launcher\Plugins\Indexer\$(var.Language)\Microsoft.Plugin.Indexer.resources.dll" />
            </Component>
            <Component
                Id="Launcher_Uri_$(var.IdSafeLanguage)_Component"
                Guid="$(var.CompGUIDPrefix)0D"
                Directory="Resource$(var.IdSafeLanguage)UriPluginFolder">
                <File Id="Launcher_Uri_$(var.IdSafeLanguage)_File" Source="$(var.BinX64Dir)modules\launcher\Plugins\Uri\$(var.Language)\Microsoft.Plugin.Uri.resources.dll" />
            </Component>
            <Component
                Id="Launcher_VSCodeWorkspaces_$(var.IdSafeLanguage)_Component"
                Guid="$(var.CompGUIDPrefix)0E"
                Directory="Resource$(var.IdSafeLanguage)VSCodeWorkspacesPluginFolder">
                <File Id="Launcher_VSCodeWorkspaces_$(var.IdSafeLanguage)_File" Source="$(var.BinX64Dir)modules\launcher\Plugins\VSCodeWorkspaces\$(var.Language)\Community.PowerToys.Run.Plugin.VSCodeWorkspaces.resources.dll" />
            </Component>
            <Component Id="Launcher_WindowWalker_$(var.IdSafeLanguage)_Component"
                       Guid="$(var.CompGUIDPrefix)0F"
                       Directory="Resource$(var.IdSafeLanguage)WindowWalkerPluginFolder">
                <File Id="Launcher_WindowWalker_$(var.IdSafeLanguage)_File" Source="$(var.BinX64Dir)modules\launcher\Plugins\WindowWalker\$(var.Language)\Microsoft.Plugin.WindowWalker.resources.dll" />
            </Component>
            <Component
                Id="Launcher_Registry_$(var.IdSafeLanguage)_Component"
                Guid="$(var.CompGUIDPrefix)10"
                Directory="Resource$(var.IdSafeLanguage)RegistryPluginFolder">
                <File Id="Launcher_Registry_$(var.IdSafeLanguage)_File" Source="$(var.BinX64Dir)modules\launcher\Plugins\Registry\$(var.Language)\Microsoft.PowerToys.Run.Plugin.Registry.resources.dll" />
            </Component>
            <Component
                Id="Launcher_Service_$(var.IdSafeLanguage)_Component"
                Guid="$(var.CompGUIDPrefix)11"
                Directory="Resource$(var.IdSafeLanguage)ServicePluginFolder">
                <File Id="Launcher_Service_$(var.IdSafeLanguage)_File" Source="$(var.BinX64Dir)modules\launcher\Plugins\Service\$(var.Language)\Microsoft.PowerToys.Run.Plugin.Service.resources.dll" />
            </Component>
            <Component
                Id="Launcher_System_$(var.IdSafeLanguage)_Component"
                Guid="$(var.CompGUIDPrefix)12"
                Directory="Resource$(var.IdSafeLanguage)SystemPluginFolder">
                <File Id="Launcher_System_$(var.IdSafeLanguage)_File" Source="$(var.BinX64Dir)modules\launcher\Plugins\System\$(var.Language)\Microsoft.PowerToys.Run.Plugin.System.resources.dll" />
            </Component>
            <Component
                Id="Launcher_WindowsSettings_$(var.IdSafeLanguage)_Component"
                Guid="$(var.CompGUIDPrefix)13"
                Directory="Resource$(var.IdSafeLanguage)WindowsSettingsPluginFolder">
                <File Id="Launcher_WindowsSettings_$(var.IdSafeLanguage)_File" Source="$(var.BinX64Dir)modules\launcher\Plugins\WindowsSettings\$(var.Language)\Microsoft.PowerToys.Run.Plugin.WindowsSettings.resources.dll" />
            </Component>
            <!-- Uncomment after Plugin receives the localization files.
                <Component 
                    Id="Launcher_WindowsTerminal_$(var.IdSafeLanguage)_Component" 
                    Guid="$(var.CompGUIDPrefix)14"                
                    Directory="Resource$(var.IdSafeLanguage)WindowsTerminalFolder">
                    <File Id="Launcher_WindowsTerminal_$(var.IdSafeLanguage)_File" Source="$(var.BinX64Dir)modules\launcher\Plugins\WindowsTerminal\$(var.Language)\Microsoft.PowerToys.Run.Plugin.WindowsTerminal.resources.dll" />
                </Component>
                -->
            <?undef IdSafeLanguage?>
            <?undef CompGUIDPrefix?>
            <?endforeach?>
            <?endif?>
        </ComponentGroup>
    </Fragment>
    <Fragment>
        <ComponentGroup Id="LauncherComponents">
            <Component Id="launcherShortcutComponent" Directory="LauncherInstallFolder" Guid="8824006B-CD06-4D87-8AC4-1B40C71DB4D7">
                <!-- Toast Notification AUMID -->
                <RegistryKey Root="HKLM" Key="SOFTWARE\Classes\AppUserModelId\PowerToysRun">
                    <RegistryValue Type="string" Name="DisplayName" Value="PowerToys Run" />
                    <RegistryValue Type="string" Name="IconUri" Value="[LauncherImagesFolder]RunAsset.ico" />
                </RegistryKey>
            </Component>

            <Component Id="launcherInstallComponent" Directory="LauncherInstallFolder" Guid="5E688DB4-C522-4268-BA54-ED1CDFFE9DB6">
                <File Source="$(var.BinX64Dir)modules\Launcher\PowerToys.Launcher.dll" />
                <?foreach File in concrt140_app.dll;e_sqlite3.dll;ICSharpCode.SharpZipLib.dll;JetBrains.Annotations.dll;Mages.Core.dll;Microsoft.Search.Interop.dll;Mono.Cecil.dll;Mono.Cecil.Mdb.dll;Mono.Cecil.Pdb.dll;Mono.Cecil.Rocks.dll;msvcp140_1_app.dll;msvcp140_2_app.dll;msvcp140_app.dll;NLog.dll;NLog.Extensions.Logging.dll;PowerToys.PowerLauncher.deps.json;PowerToys.PowerLauncher.dll;PowerToys.PowerLauncher.exe;Microsoft.Xaml.Behaviors.dll;System.Text.Json.dll;PowerToys.PowerLauncher.runtimeconfig.json;System.Data.OleDb.dll;UnitsNet.dll;vcamp140_app.dll;vccorlib140_app.dll;vcomp140_app.dll;vcruntime140_1_app.dll;vcruntime140_app.dll;Wox.Infrastructure.dll;Wox.Plugin.dll;PowerToys.Interop.dll;PowerToys.ManagedTelemetry.dll;PowerToys.PowerLauncher.Telemetry.dll;Microsoft.Data.Sqlite.dll;SQLitePCLRaw.batteries_v2.dll;SQLitePCLRaw.core.dll;SQLitePCLRaw.provider.e_sqlite3.dll;Microsoft.Extensions.Configuration.Abstractions.dll;Microsoft.Extensions.Configuration.Binder.dll;Microsoft.Extensions.Configuration.dll;Microsoft.Extensions.DependencyInjection.Abstractions.dll;Microsoft.Extensions.DependencyInjection.dll;Microsoft.Extensions.Logging.Abstractions.dll;Microsoft.Extensions.Logging.dll;Microsoft.Extensions.Options.dll;Microsoft.Extensions.Primitives.dll;ControlzEx.dll;PowerToys.ManagedCommon.dll;System.IO.Abstractions.dll;PowerToys.Common.UI.dll;System.ServiceProcess.ServiceController.dll;Microsoft.Toolkit.Uwp.Notifications.dll;ModernWpf.Controls.dll;ModernWpf.dll;WinRT.Runtime.dll;Microsoft.Windows.SDK.NET.dll?>
                <File Id="File_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\$(var.File)" />
                <?endforeach?>
                <File Source="$(var.BinX64Dir)Settings\PowerToys.Settings.UI.Lib.dll" />
                <!-- VCRuntime -->
                <?foreach File in vcruntime140.dll;vcruntime140_1.dll;concrt140.dll;msvcp140.dll;msvcp140_1.dll;msvcp140_2.dll;msvcp140_codecvt_ids.dll;vccorlib140.dll?>
                <File Id="File_$(var.File)" Source="$(var.RepoDir)installer\VCRuntime\$(var.File)" />
                <?endforeach?>
            </Component>
            <Component Id="launcherImagesComponent" Directory="LauncherImagesFolder" Guid="D254220C-1DD9-4C74-8810-1AAB2F940DE8">
                <?foreach File in app.dark.png;app.light.png;app_error.dark.png;app_error.light.png;RunAsset.ico?>
                <File Id="File_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Images\$(var.File)" />
                <?endforeach?>
            </Component>

            <!-- Calculator Plugin -->
            <Component Id="calculatorComponent" Directory="CalculatorPluginFolder" Guid="19DE1022-583C-4969-9AFC-D43CB944003D">
                <?foreach File in plugin.json;Microsoft.PowerToys.Run.Plugin.Calculator.deps.json;Microsoft.PowerToys.Run.Plugin.Calculator.dll;PowerToys.ManagedTelemetry.dll?>
                <File Id="Calculator_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Calculator\$(var.File)" />
                <?endforeach?>
            </Component>
            <Component Id="calculatorImagesComponent" Directory="CalculatorImagesFolder" Guid="07EC9232-CF9A-4CDB-8D8E-E79DC75096C0">
                <File Id="calculatorPluginImg_calculator_light" Source="$(var.BinX64Dir)modules\launcher\Plugins\Calculator\Images\calculator.light.png" />
                <File Id="calculatorPluginImg_calculator_dark" Source="$(var.BinX64Dir)modules\launcher\Plugins\Calculator\Images\calculator.dark.png" />
            </Component>

            <!-- Folder Plugin -->
            <Component Id="FolderComponent" Directory="FolderPluginFolder" Guid="453D6C29-8F0D-46EC-B210-82E6AF547039">
                <?foreach File in plugin.json;Microsoft.Plugin.Folder.deps.json;Microsoft.Plugin.Folder.dll;PowerToys.ManagedTelemetry.dll?>
                <File Id="Folder_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Folder\$(var.File)" />
                <?endforeach?>
            </Component>
            <Component Id="FolderImagesComponent" Directory="FolderPluginImagesFolder" Guid="6C5226EB-E312-4768-B4D1-B1D3ACFCCBDF">
                <?foreach File in copy.dark.png;copy.light.png;delete.dark.png;delete.light.png;file.dark.png;file.light.png;folder.dark.png;folder.light.png;user.dark.png;user.light.png;Warning.dark.png;Warning.light.png?>
                <File Id="FolderPlugin_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Folder\Images\$(var.File)" />
                <?endforeach?>
            </Component>

            <!-- Program Plugin -->
            <Component Id="ProgramComponent" Directory="ProgramPluginFolder" Guid="3C5CA6E6-3D36-4F4E-B40E-38AA5E5CB799">
                <?foreach File in plugin.json;Microsoft.Plugin.Program.deps.json;Microsoft.Plugin.Program.dll;PowerToys.ManagedTelemetry.dll?>
                <File Id="Program_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Program\$(var.File)" />
                <?endforeach?>
            </Component>
            <Component Id="ProgramImagesComponent" Directory="ProgramImagesFolder" Guid="30D357F5-406F-47D1-BEFE-6022746469B4">
                <?foreach File in app.dark.png;app.light.png;disable.light.png;disable.dark.png;folder.light.png;folder.dark.png;shell.light.png;shell.dark.png;user.light.png;user.dark.png?>
                <File Id="Program_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Program\Images\$(var.File)" />
                <?endforeach?>
            </Component>

            <!-- Shell Plugin -->
            <Component Id="ShellComponent" Directory="ShellPluginFolder" Guid="6D3D7294-1804-47C9-83E5-47A8867F3801">
                <?foreach File in plugin.json;Microsoft.Plugin.Shell.deps.json;Microsoft.Plugin.Shell.dll;PowerToys.ManagedTelemetry.dll?>
                <File Id="Shell_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Shell\$(var.File)" />
                <?endforeach?>
            </Component>
            <Component Id="ShellImagesComponent" Directory="ShellImagesFolder" Guid="15B5DBAE-E7C1-4BF7-A29E-6CE76242F8F4">
                <?foreach File in shell.light.png;shell.dark.png;user.light.png;user.dark.png?>
                <File Id="Shell_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Shell\Images\$(var.File)" />
                <?endforeach?>
            </Component>

            <!-- Indexer Plugin -->
            <Component Id="IndexerComponent" Directory="IndexerPluginFolder" Guid="FEA9816A-B4F7-42CC-99AF-B05F3E7F7EBF">
                <?foreach File in Microsoft.Plugin.Indexer.deps.json;Microsoft.Plugin.Indexer.dll;plugin.json;PowerToys.ManagedTelemetry.dll?>
                <File Id="Indexer_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Indexer\$(var.File)" />
                <?endforeach?>
            </Component>
            <Component Id="IndexerImagesComponent" Directory="IndexerImagesFolder" Guid="DB2E8D49-D104-425B-9616-952AC8CAB676">
                <?foreach File in indexer.dark.png;indexer.light.png;Warning.light.png;Warning.dark.png?>
                <File Id="Indexer_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Indexer\Images\$(var.File)" />
                <?endforeach?>
            </Component>

            <!-- UnitConverter Plugin -->
            <Component Id="UnitConverterComponent" Directory="UnitConverterPluginFolder" Guid="D4F429E3-C619-49D6-9416-88A757D18E02">
                <?foreach File in plugin.json;Community.PowerToys.Run.Plugin.UnitConverter.deps.json;Community.PowerToys.Run.Plugin.UnitConverter.dll?>
                <File Id="UnitConverter_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\UnitConverter\$(var.File)" />
                <?endforeach?>
            </Component>
            <Component Id="UnitConverterImagesComponent" Directory="UnitConverterImagesFolder" Guid="16ABD217-0898-47B2-89D9-AF1ABF00F543">
                <File Id="UnitConverterLight" Source="$(var.BinX64Dir)modules\launcher\Plugins\UnitConverter\Images\unitconverter.light.png" />
                <File Id="UnitConverterDark" Source="$(var.BinX64Dir)modules\launcher\Plugins\UnitConverter\Images\unitconverter.dark.png" />
            </Component>

            <!-- WebSearch Plugin -->
            <Component Id="WebSearchComponent" Directory="WebSearchPluginFolder" Guid="C996F2B4-FF2E-4277-9175-494B6A613898">
                <?foreach File in plugin.json;Community.PowerToys.Run.Plugin.WebSearch.deps.json;Community.PowerToys.Run.Plugin.WebSearch.dll?>
                <File Id="WebSearch_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\WebSearch\$(var.File)" />
                <?endforeach?>
            </Component>
            <Component Id="WebSearchImagesComponent" Directory="WebSearchImagesFolder" Guid="B3A5DA32-FA87-47E6-81F6-0454BA95CCA4">
                <File Id="WebSearchLight" Source="$(var.BinX64Dir)modules\launcher\Plugins\WebSearch\Images\WebSearch.light.png" />
                <File Id="WebSearchDark" Source="$(var.BinX64Dir)modules\launcher\Plugins\WebSearch\Images\WebSearch.dark.png" />
            </Component>

            <!-- Uri Plugin -->
            <Component Id="UriComponent" Directory="UriPluginFolder" Guid="C7DC8F88-554C-4375-9510-9435399B5D3D">
                <?foreach File in plugin.json;Microsoft.Plugin.Uri.deps.json;Microsoft.Plugin.Uri.dll;PowerToys.ManagedTelemetry.dll?>
                <File Id="Uri_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Uri\$(var.File)" />
                <?endforeach?>
            </Component>
            <Component Id="UriImagesComponent" Directory="UriImagesFolder" Guid="8C9C1634-28C8-45C4-A8EA-8D4C9B4810D0">
                <File Id="UriDarkIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\Uri\Images\Uri.dark.png" />
                <File Id="UriLightIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\Uri\Images\Uri.light.png" />
            </Component>

            <!-- VSCodeWorkspaces Plugin -->
            <Component Id="VSCodeWorkspacesComponent" Directory="VSCodeWorkspacesPluginFolder" Guid="78363DBD-7E38-4D5F-8987-9963DF609B94">
                <File Id="VSCodeWorkspaceFolder_deps" Source="$(var.BinX64Dir)modules\launcher\Plugins\VSCodeWorkspaces\Community.PowerToys.Run.Plugin.VSCodeWorkspaces.deps.json" />
                <?foreach File in plugin.json;Community.PowerToys.Run.Plugin.VSCodeWorkspaces.dll?>
                <File Id="VSCodeWorkspaces_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\VSCodeWorkspaces\$(var.File)" />
                <?endforeach?>
            </Component>
            <Component Id="VSCodeWorkspacesImagesComponent" Directory="VSCodeWorkspaceImagesFolder" Guid="6F3C0CF1-7024-4333-BFA1-850D340AEE69">
                <File Id="VSCodeWorkspaceCodeLight" Source="$(var.BinX64Dir)modules\launcher\Plugins\VSCodeWorkspaces\Images\code-light.png" />
                <File Id="VSCodeWorkspaceCodeDark" Source="$(var.BinX64Dir)modules\launcher\Plugins\VSCodeWorkspaces\Images\code-dark.png" />
                <File Id="VSCodeWorkspaceFolder" Source="$(var.BinX64Dir)modules\launcher\Plugins\VSCodeWorkspaces\Images\folder.png" />
                <File Id="VSCodeWorkspaceRemote" Source="$(var.BinX64Dir)modules\launcher\Plugins\VSCodeWorkspaces\Images\monitor.png" />
            </Component>

            <!-- WindowWalker Plugin -->
            <Component Id="WindowWalkerComponent" Directory="WindowWalkerPluginFolder" Guid="EB1391C9-B701-421F-80FC-ABB2FEDFAD19">
                <?foreach File in plugin.json;Microsoft.Plugin.WindowWalker.deps.json;Microsoft.Plugin.WindowWalker.dll;PowerToys.ManagedTelemetry.dll?>
                <File Id="WindowWalker_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\WindowWalker\$(var.File)" />
                <?endforeach?>
            </Component>
            <Component Id="WindowWalkerImagesComponent" Directory="WindowWalkerImagesFolder" Guid="3944A7F5-77F4-4979-9911-EDE709B2F509">
                <File Id="WindowWalkerDarkIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\WindowWalker\Images\windowwalker.dark.png" />
                <File Id="WindowWalkerLightIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\WindowWalker\Images\windowwalker.light.png" />
            </Component>

            <!-- Registry Plugin -->
            <Component Id="RegistryComponent" Directory="RegistryPluginFolder" Guid="186FDFDC-12F1-4221-BEF6-DE6763F54B18">
                <?foreach File in plugin.json;Microsoft.PowerToys.Run.Plugin.Registry.deps.json;Microsoft.PowerToys.Run.Plugin.Registry.dll;PowerToys.ManagedTelemetry.dll?>
                <File Id="Registry_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Registry\$(var.File)" />
                <?endforeach?>
            </Component>
            <Component Id="RegistryImagesComponent" Directory="RegistryImagesFolder" Guid="2E2C91A2-9F53-40C6-BBE9-E6FD6D6E94EB">
                <File Id="RegistryDarkIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\Registry\Images\reg.dark.png" />
                <File Id="RegistryLightIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\Registry\Images\reg.light.png" />
            </Component>

            <!-- Service Plugin -->
            <Component Id="ServiceComponent" Directory="ServicePluginFolder" Guid="66245D20-0078-4136-8A34-4A282FB894D5">
                <?foreach File in plugin.json;Microsoft.PowerToys.Run.Plugin.Service.deps.json;Microsoft.PowerToys.Run.Plugin.Service.dll?>
                <File Id="Service_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Service\$(var.File)" />
                <?endforeach?>
            </Component>
            <Component Id="ServiceImagesComponent" Directory="ServiceImagesFolder" Guid="5846BF01-5BCB-47DC-9472-0E478A41B1AE">
                <File Id="ServiceDarkIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\Service\Images\service.dark.png" />
                <File Id="ServiceLightIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\Service\Images\service.light.png" />
            </Component>

            <!-- System Plugin -->
            <Component Id="SystemComponent" Directory="SystemPluginFolder" Guid="05894C7C-7207-4669-ADB9-E02DD9DB4CCD">
                <?foreach File in plugin.json;Microsoft.PowerToys.Run.Plugin.System.deps.json;Microsoft.PowerToys.Run.Plugin.System.dll?>
                <File Id="System_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\System\$(var.File)" />
                <?endforeach?>
            </Component>
            <Component Id="SystemImagesComponent" Directory="SystemImagesFolder" Guid="8886318A-0CD8-4990-85D1-50D44D5ADA21">
                <File Id="SystemLockDarkIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\System\Images\lock.dark.png" />
                <File Id="SystemLockLightIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\System\Images\lock.light.png" />
                <File Id="SystemLogoffDarkIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\System\Images\logoff.dark.png" />
                <File Id="SystemLogoffLightIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\System\Images\logoff.light.png" />
                <File Id="SystemRecyclebinDarkIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\System\Images\recyclebin.dark.png" />
                <File Id="SystemRecyclebinLightIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\System\Images\recyclebin.light.png" />
                <File Id="SystemRestartDarkIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\System\Images\restart.dark.png" />
                <File Id="SystemRestartLightIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\System\Images\restart.light.png" />
                <File Id="SystemShutdownDarkIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\System\Images\shutdown.dark.png" />
                <File Id="SystemShutdownLightIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\System\Images\shutdown.light.png" />
                <File Id="SystemSleepDarkIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\System\Images\sleep.dark.png" />
                <File Id="SystemSleepLightIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\System\Images\sleep.light.png" />
				<File Id="SystemFirmwareSettingsDarkIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\System\Images\firmwareSettings.dark.png" />
                <File Id="SystemFirmwareSettingsLightIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\System\Images\firmwareSettings.light.png" />
            </Component>

            <!-- WindowsSettings Plugin -->
            <Component Id="WindowsSettingsComponent" Directory="WindowsSettingsPluginFolder" Guid="ACEC2B6D-8E95-43BF-A1E4-137E95F07C96">
                <?foreach File in plugin.json;Microsoft.PowerToys.Run.Plugin.WindowsSettings.deps.json;Microsoft.PowerToys.Run.Plugin.WindowsSettings.dll;PowerToys.ManagedTelemetry.dll?>
                <File Id="WindowsSettings_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\WindowsSettings\$(var.File)" />
                <?endforeach?>
            </Component>
            <Component Id="WindowsSettingsImagesComponent" Directory="WindowsSettingsImagesFolder" Guid="E1CE33A7-6318-4FA6-A46B-9302A00BD6AA">
                <File Id="WindowsSettingsDarkIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\WindowsSettings\Images\WindowsSettings.dark.png" />
                <File Id="WindowsSettingsLightIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\WindowsSettings\Images\WindowsSettings.light.png" />
            </Component>

            <!-- WindowsTerminal Plugin -->
            <Component Id="WindowsTerminalComponent" Directory="WindowsTerminalPluginFolder" Guid="5392FD11-9A69-4409-A711-748C225F1A18">
                <?foreach File in plugin.json;Microsoft.PowerToys.Run.Plugin.WindowsTerminal.deps.json;Microsoft.PowerToys.Run.Plugin.WindowsTerminal.dll;PowerToys.ManagedTelemetry.dll?>
                <File Id="WindowsTerminal_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\WindowsTerminal\$(var.File)" />
                <?endforeach?>
            </Component>
            <Component Id="WindowsTerminalImagesComponent" Directory="WindowsTerminalImagesFolder" Guid="CDD21BEB-E2F3-4138-A1F8-72FD3B52706A">
                <File Id="WindowsTerminalDarkIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\WindowsTerminal\Images\WindowsTerminal.dark.png" />
                <File Id="WindowsTerminalLightIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\WindowsTerminal\Images\WindowsTerminal.light.png" />
            </Component>

        </ComponentGroup>
    </Fragment>
</Wix>
